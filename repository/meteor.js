var po=Object.defineProperty;var yo=(ct,st,_t)=>st in ct?po(ct,st,{enumerable:!0,configurable:!0,writable:!0,value:_t}):ct[st]=_t;var l=(ct,st,_t)=>yo(ct,typeof st!="symbol"?st+"":st,_t);(function(){"use strict";var Nt;var ct=["u8","u16","u32","u64","u128","i8","i16","i32","i64","i128","f32","f64"],st=function(){function t(){this.offset=0,this.buffer_size=256,this.buffer=new ArrayBuffer(this.buffer_size),this.view=new DataView(this.buffer)}return t.prototype.resize_if_necessary=function(e){if(this.buffer_size-this.offset<e){this.buffer_size=Math.max(this.buffer_size*2,this.buffer_size+e);var n=new ArrayBuffer(this.buffer_size);new Uint8Array(n).set(new Uint8Array(this.buffer)),this.buffer=n,this.view=new DataView(n)}},t.prototype.get_used_buffer=function(){return new Uint8Array(this.buffer).slice(0,this.offset)},t.prototype.store_value=function(e,n){var r=n.substring(1),s=parseInt(r)/8;this.resize_if_necessary(s);var o=n[0]==="f"?"setFloat".concat(r):n[0]==="i"?"setInt".concat(r):"setUint".concat(r);this.view[o](this.offset,e,!0),this.offset+=s},t.prototype.store_bytes=function(e){this.resize_if_necessary(e.length),new Uint8Array(this.buffer).set(new Uint8Array(e),this.offset),this.offset+=e.length},t}(),_t=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(r[o]=s[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();function Zn(t){return Array.isArray(t)||!!t&&typeof t=="object"&&"length"in t&&typeof t.length=="number"&&(t.length===0||t.length>0&&t.length-1 in t)}function Et(t,e,n){if(typeof t!==e)throw new Error("Expected ".concat(e," not ").concat(typeof t,"(").concat(t,") at ").concat(n.join(".")))}function Vn(t,e){var n=["number","string","bigint","boolean"].includes(typeof t),r=typeof t=="object"&&t!==null&&"toString"in t;if(!n&&!r)throw new Error("Expected bigint, number, boolean or string not ".concat(typeof t,"(").concat(t,") at ").concat(e.join(".")))}function De(t,e,n){if(t!==e)throw new Error("Array length ".concat(t," does not match schema length ").concat(e," at ").concat(n.join(".")))}function Yn(t,e){if(typeof t!="object"||t===null)throw new Error("Expected object not ".concat(typeof t,"(").concat(t,") at ").concat(e.join(".")))}var Re=ct.concat(["bool","string"]),Ce=["option","enum","array","set","map","struct"],At=function(t){_t(e,t);function e(n,r){var s="Invalid schema: ".concat(JSON.stringify(n)," expected ").concat(r);return t.call(this,s)||this}return e}(Error);function at(t){if(!(typeof t=="string"&&Re.includes(t))){if(t&&typeof t=="object"){var e=Object.keys(t);if(e.length===1&&Ce.includes(e[0])){var n=e[0];if(n==="option")return at(t[n]);if(n==="enum")return Gn(t[n]);if(n==="array")return Jn(t[n]);if(n==="set")return at(t[n]);if(n==="map")return Xn(t[n]);if(n==="struct")return Qn(t[n])}}throw new At(t,Ce.join(", ")+" or "+Re.join(", "))}}function Gn(t){if(!Array.isArray(t))throw new At(t,"Array");for(var e=0,n=t;e<n.length;e++){var r=n[e];if(typeof r!="object"||!("struct"in r))throw new Error('Missing "struct" key in enum schema');if(typeof r.struct!="object"||Object.keys(r.struct).length!==1)throw new Error('The "struct" in each enum must have a single key');at({struct:r.struct})}}function Jn(t){if(typeof t!="object")throw new At(t,"{ type, len? }");if(t.len&&typeof t.len!="number")throw new Error("Invalid schema: ".concat(t));if("type"in t)return at(t.type);throw new At(t,"{ type, len? }")}function Xn(t){if(typeof t=="object"&&"key"in t&&"value"in t)at(t.key),at(t.value);else throw new At(t,"{ key, value }")}function Qn(t){if(typeof t!="object")throw new At(t,"object");for(var e in t)at(t[e])}var tr=function(){function t(e){this.encoded=new st,this.fieldPath=["value"],this.checkTypes=e}return t.prototype.encode=function(e,n){return this.encode_value(e,n),this.encoded.get_used_buffer()},t.prototype.encode_value=function(e,n){if(typeof n=="string"){if(ct.includes(n))return this.encode_integer(e,n);if(n==="string")return this.encode_string(e);if(n==="bool")return this.encode_boolean(e)}if(typeof n=="object"){if("option"in n)return this.encode_option(e,n);if("enum"in n)return this.encode_enum(e,n);if("array"in n)return this.encode_array(e,n);if("set"in n)return this.encode_set(e,n);if("map"in n)return this.encode_map(e,n);if("struct"in n)return this.encode_struct(e,n)}},t.prototype.encode_integer=function(e,n){var r=parseInt(n.substring(1));r<=32||n=="f64"?(this.checkTypes&&Et(e,"number",this.fieldPath),this.encoded.store_value(e,n)):(this.checkTypes&&Vn(e,this.fieldPath),this.encode_bigint(BigInt(e),r))},t.prototype.encode_bigint=function(e,n){for(var r=n/8,s=new Uint8Array(r),o=0;o<r;o++)s[o]=Number(e&BigInt(255)),e=e>>BigInt(8);this.encoded.store_bytes(new Uint8Array(s))},t.prototype.encode_string=function(e){this.checkTypes&&Et(e,"string",this.fieldPath);for(var n=e,r=[],s=0;s<n.length;s++){var o=n.charCodeAt(s);o<128?r.push(o):o<2048?r.push(192|o>>6,128|o&63):o<55296||o>=57344?r.push(224|o>>12,128|o>>6&63,128|o&63):(s++,o=65536+((o&1023)<<10|n.charCodeAt(s)&1023),r.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|o&63))}this.encoded.store_value(r.length,"u32"),this.encoded.store_bytes(new Uint8Array(r))},t.prototype.encode_boolean=function(e){this.checkTypes&&Et(e,"boolean",this.fieldPath),this.encoded.store_value(e?1:0,"u8")},t.prototype.encode_option=function(e,n){e==null?this.encoded.store_value(0,"u8"):(this.encoded.store_value(1,"u8"),this.encode_value(e,n.option))},t.prototype.encode_enum=function(e,n){this.checkTypes&&Yn(e,this.fieldPath);for(var r=Object.keys(e)[0],s=0;s<n.enum.length;s++){var o=n.enum[s];if(r===Object.keys(o.struct)[0])return this.encoded.store_value(s,"u8"),this.encode_struct(e,o)}throw new Error("Enum key (".concat(r,") not found in enum schema: ").concat(JSON.stringify(n)," at ").concat(this.fieldPath.join(".")))},t.prototype.encode_array=function(e,n){if(Zn(e))return this.encode_arraylike(e,n);if(e instanceof ArrayBuffer)return this.encode_buffer(e,n);throw new Error("Expected Array-like not ".concat(typeof e,"(").concat(e,") at ").concat(this.fieldPath.join(".")))},t.prototype.encode_arraylike=function(e,n){n.array.len?De(e.length,n.array.len,this.fieldPath):this.encoded.store_value(e.length,"u32");for(var r=0;r<e.length;r++)this.encode_value(e[r],n.array.type)},t.prototype.encode_buffer=function(e,n){n.array.len?De(e.byteLength,n.array.len,this.fieldPath):this.encoded.store_value(e.byteLength,"u32"),this.encoded.store_bytes(new Uint8Array(e))},t.prototype.encode_set=function(e,n){this.checkTypes&&Et(e,"object",this.fieldPath);var r=e instanceof Set,s=r?Array.from(e.values()):Object.values(e);this.encoded.store_value(s.length,"u32");for(var o=0,a=s;o<a.length;o++){var i=a[o];this.encode_value(i,n.set)}},t.prototype.encode_map=function(e,n){this.checkTypes&&Et(e,"object",this.fieldPath);var r=e instanceof Map,s=r?Array.from(e.keys()):Object.keys(e);this.encoded.store_value(s.length,"u32");for(var o=0,a=s;o<a.length;o++){var i=a[o];this.encode_value(i,n.map.key),this.encode_value(r?e.get(i):e[i],n.map.value)}},t.prototype.encode_struct=function(e,n){this.checkTypes&&Et(e,"object",this.fieldPath);for(var r=0,s=Object.keys(n.struct);r<s.length;r++){var o=s[r];this.fieldPath.push(o),this.encode_value(e[o],n.struct[o]),this.fieldPath.pop()}},t}();function Xt(t,e,n){n===void 0&&(n=!0),n&&at(t);var r=new tr(n);return r.encode(e,t)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ne(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Qt(t,e=""){if(!Number.isSafeInteger(t)||t<0){const n=e&&`"${e}" `;throw new Error(`${n}expected integer >= 0, got ${t}`)}}function z(t,e,n=""){const r=Ne(t),s=t==null?void 0:t.length,o=e!==void 0;if(!r||o&&s!==e){const a=n&&`"${n}" `,i=o?` of length ${e}`:"",c=r?`length=${s}`:`type=${typeof t}`;throw new Error(a+"expected Uint8Array"+i+", got "+c)}return t}function Pe(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function er(t,e){z(t,void 0,"digestInto() output");const n=e.outputLen;if(t.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function Pt(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function te(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function X(t,e){return t<<32-e|t>>>e}const Ke=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",nr=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ee(t){if(z(t),Ke)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=nr[t[n]];return e}const ot={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ue(t){if(t>=ot._0&&t<=ot._9)return t-ot._0;if(t>=ot.A&&t<=ot.F)return t-(ot.A-10);if(t>=ot.a&&t<=ot.f)return t-(ot.a-10)}function Me(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(Ke)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,o=0;s<n;s++,o+=2){const a=Ue(t.charCodeAt(o)),i=Ue(t.charCodeAt(o+1));if(a===void 0||i===void 0){const c=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}r[s]=a*16+i}return r}function Le(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];z(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const o=t[r];n.set(o,s),s+=o.length}return n}function ke(t,e={}){const n=(s,o)=>t(o).update(s).digest(),r=t(void 0);return n.outputLen=r.outputLen,n.blockLen=r.blockLen,n.create=s=>t(s),Object.assign(n,e),Object.freeze(n)}function rr(t=32){const e=typeof globalThis=="object"?globalThis.crypto:null;if(typeof(e==null?void 0:e.getRandomValues)!="function")throw new Error("crypto.getRandomValues must be defined");return e.getRandomValues(new Uint8Array(t))}const qe=t=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,t])});function sr(t,e,n){return t&e^~t&n}function or(t,e,n){return t&e^t&n^e&n}class je{constructor(e,n,r,s){l(this,"blockLen");l(this,"outputLen");l(this,"padOffset");l(this,"isLE");l(this,"buffer");l(this,"view");l(this,"finished",!1);l(this,"length",0);l(this,"pos",0);l(this,"destroyed",!1);this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=te(this.buffer)}update(e){Pe(this),z(e);const{view:n,buffer:r,blockLen:s}=this,o=e.length;for(let a=0;a<o;){const i=Math.min(s-this.pos,o-a);if(i===s){const c=te(e);for(;s<=o-a;a+=s)this.process(c,a);continue}r.set(e.subarray(a,a+i),this.pos),this.pos+=i,a+=i,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Pe(this),er(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:o}=this;let{pos:a}=this;n[a++]=128,Pt(this.buffer.subarray(a)),this.padOffset>s-a&&(this.process(r,0),a=0);for(let f=a;f<s;f++)n[f]=0;r.setBigUint64(s-8,BigInt(this.length*8),o),this.process(r,0);const i=te(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const u=c/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)i.setUint32(4*f,d[f],o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:o,destroyed:a,pos:i}=this;return e.destroyed=a,e.finished=o,e.length=s,e.pos=i,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const ut=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Z=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),qt=BigInt(2**32-1),$e=BigInt(32);function ir(t,e=!1){return e?{h:Number(t&qt),l:Number(t>>$e&qt)}:{h:Number(t>>$e&qt)|0,l:Number(t&qt)|0}}function cr(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let o=0;o<n;o++){const{h:a,l:i}=ir(t[o],e);[r[o],s[o]]=[a,i]}return[r,s]}const He=(t,e,n)=>t>>>n,Fe=(t,e,n)=>t<<32-n|e>>>n,vt=(t,e,n)=>t>>>n|e<<32-n,St=(t,e,n)=>t<<32-n|e>>>n,jt=(t,e,n)=>t<<64-n|e>>>n-32,$t=(t,e,n)=>t>>>n-32|e<<64-n;function it(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const ar=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),ur=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,fr=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),lr=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,dr=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),hr=(t,e,n,r,s,o)=>e+n+r+s+o+(t/2**32|0)|0,gr=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ft=new Uint32Array(64);class pr extends je{constructor(e){super(64,e,8,!1)}get(){const{A:e,B:n,C:r,D:s,E:o,F:a,G:i,H:c}=this;return[e,n,r,s,o,a,i,c]}set(e,n,r,s,o,a,i,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=a|0,this.G=i|0,this.H=c|0}process(e,n){for(let f=0;f<16;f++,n+=4)ft[f]=e.getUint32(n,!1);for(let f=16;f<64;f++){const m=ft[f-15],v=ft[f-2],S=X(m,7)^X(m,18)^m>>>3,E=X(v,17)^X(v,19)^v>>>10;ft[f]=E+ft[f-7]+S+ft[f-16]|0}let{A:r,B:s,C:o,D:a,E:i,F:c,G:u,H:d}=this;for(let f=0;f<64;f++){const m=X(i,6)^X(i,11)^X(i,25),v=d+m+sr(i,c,u)+gr[f]+ft[f]|0,E=(X(r,2)^X(r,13)^X(r,22))+or(r,s,o)|0;d=u,u=c,c=i,i=a+v|0,a=o,o=s,s=r,r=v+E|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,a=a+this.D|0,i=i+this.E|0,c=c+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(r,s,o,a,i,c,u,d)}roundClean(){Pt(ft)}destroy(){this.set(0,0,0,0,0,0,0,0),Pt(this.buffer)}}class yr extends pr{constructor(){super(32);l(this,"A",ut[0]|0);l(this,"B",ut[1]|0);l(this,"C",ut[2]|0);l(this,"D",ut[3]|0);l(this,"E",ut[4]|0);l(this,"F",ut[5]|0);l(this,"G",ut[6]|0);l(this,"H",ut[7]|0)}}const ze=cr(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),wr=ze[0],br=ze[1],lt=new Uint32Array(80),dt=new Uint32Array(80);class xr extends je{constructor(e){super(128,e,16,!1)}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:o,Cl:a,Dh:i,Dl:c,Eh:u,El:d,Fh:f,Fl:m,Gh:v,Gl:S,Hh:E,Hl:b}=this;return[e,n,r,s,o,a,i,c,u,d,f,m,v,S,E,b]}set(e,n,r,s,o,a,i,c,u,d,f,m,v,S,E,b){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=o|0,this.Cl=a|0,this.Dh=i|0,this.Dl=c|0,this.Eh=u|0,this.El=d|0,this.Fh=f|0,this.Fl=m|0,this.Gh=v|0,this.Gl=S|0,this.Hh=E|0,this.Hl=b|0}process(e,n){for(let g=0;g<16;g++,n+=4)lt[g]=e.getUint32(n),dt[g]=e.getUint32(n+=4);for(let g=16;g<80;g++){const _=lt[g-15]|0,T=dt[g-15]|0,M=vt(_,T,1)^vt(_,T,8)^He(_,T,7),L=St(_,T,1)^St(_,T,8)^Fe(_,T,7),w=lt[g-2]|0,x=dt[g-2]|0,B=vt(w,x,19)^jt(w,x,61)^He(w,x,6),N=St(w,x,19)^$t(w,x,61)^Fe(w,x,6),P=fr(L,N,dt[g-7],dt[g-16]),k=lr(P,M,B,lt[g-7],lt[g-16]);lt[g]=k|0,dt[g]=P|0}let{Ah:r,Al:s,Bh:o,Bl:a,Ch:i,Cl:c,Dh:u,Dl:d,Eh:f,El:m,Fh:v,Fl:S,Gh:E,Gl:b,Hh:O,Hl:y}=this;for(let g=0;g<80;g++){const _=vt(f,m,14)^vt(f,m,18)^jt(f,m,41),T=St(f,m,14)^St(f,m,18)^$t(f,m,41),M=f&v^~f&E,L=m&S^~m&b,w=dr(y,T,L,br[g],dt[g]),x=hr(w,O,_,M,wr[g],lt[g]),B=w|0,N=vt(r,s,28)^jt(r,s,34)^jt(r,s,39),P=St(r,s,28)^$t(r,s,34)^$t(r,s,39),k=r&o^r&i^o&i,p=s&a^s&c^a&c;O=E|0,y=b|0,E=v|0,b=S|0,v=f|0,S=m|0,{h:f,l:m}=it(u|0,d|0,x|0,B|0),u=i|0,d=c|0,i=o|0,c=a|0,o=r|0,a=s|0;const h=ar(B,P,p);r=ur(h,x,N,k),s=h|0}({h:r,l:s}=it(this.Ah|0,this.Al|0,r|0,s|0)),{h:o,l:a}=it(this.Bh|0,this.Bl|0,o|0,a|0),{h:i,l:c}=it(this.Ch|0,this.Cl|0,i|0,c|0),{h:u,l:d}=it(this.Dh|0,this.Dl|0,u|0,d|0),{h:f,l:m}=it(this.Eh|0,this.El|0,f|0,m|0),{h:v,l:S}=it(this.Fh|0,this.Fl|0,v|0,S|0),{h:E,l:b}=it(this.Gh|0,this.Gl|0,E|0,b|0),{h:O,l:y}=it(this.Hh|0,this.Hl|0,O|0,y|0),this.set(r,s,o,a,i,c,u,d,f,m,v,S,E,b,O,y)}roundClean(){Pt(lt,dt)}destroy(){Pt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class mr extends xr{constructor(){super(64);l(this,"Ah",Z[0]|0);l(this,"Al",Z[1]|0);l(this,"Bh",Z[2]|0);l(this,"Bl",Z[3]|0);l(this,"Ch",Z[4]|0);l(this,"Cl",Z[5]|0);l(this,"Dh",Z[6]|0);l(this,"Dl",Z[7]|0);l(this,"Eh",Z[8]|0);l(this,"El",Z[9]|0);l(this,"Fh",Z[10]|0);l(this,"Fl",Z[11]|0);l(this,"Gh",Z[12]|0);l(this,"Gl",Z[13]|0);l(this,"Hh",Z[14]|0);l(this,"Hl",Z[15]|0)}}const _r=ke(()=>new yr,qe(1)),Er=ke(()=>new mr,qe(3));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const We=BigInt(0),Ze=BigInt(1);function ne(t,e=""){if(typeof t!="boolean"){const n=e&&`"${e}" `;throw new Error(n+"expected boolean, got type="+typeof t)}return t}function Ar(t){if(typeof t=="bigint"){if(!Ft(t))throw new Error("positive bigint expected, got "+t)}else Qt(t);return t}function Ve(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?We:BigInt("0x"+t)}function vr(t){return Ve(ee(t))}function Ht(t){return Ve(ee(re(z(t)).reverse()))}function Ye(t,e){Qt(e),t=Ar(t);const n=Me(t.toString(16).padStart(e*2,"0"));if(n.length!==e)throw new Error("number too large");return n}function Sr(t,e){return Ye(t,e).reverse()}function re(t){return Uint8Array.from(t)}const Ft=t=>typeof t=="bigint"&&We<=t;function Br(t,e,n){return Ft(t)&&Ft(e)&&Ft(n)&&e<=t&&t<n}function Ge(t,e,n,r){if(!Br(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}const Ir=t=>(Ze<<BigInt(t))-Ze;function se(t,e={},n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(o,a,i){const c=t[o];if(i&&c===void 0)return;const u=typeof c;if(u!==a||c===null)throw new Error(`param "${o}" is invalid: expected ${a}, got ${u}`)}const s=(o,a)=>Object.entries(o).forEach(([i,c])=>r(i,c,a));s(e,!1),s(n,!0)}function Je(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const o=t(n,...r);return e.set(n,o),o}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const G=BigInt(0),Y=BigInt(1),yt=BigInt(2),Xe=BigInt(3),Qe=BigInt(4),tn=BigInt(5),Or=BigInt(7),en=BigInt(8),Tr=BigInt(9),nn=BigInt(16);function $(t,e){const n=t%e;return n>=G?n:e+n}function Q(t,e,n){let r=t;for(;e-- >G;)r*=r,r%=n;return r}function rn(t,e){if(t===G)throw new Error("invert: expected non-zero number");if(e<=G)throw new Error("invert: expected positive modulus, got "+e);let n=$(t,e),r=e,s=G,o=Y;for(;n!==G;){const i=r/n,c=r%n,u=s-o*i;r=n,n=c,s=o,o=u}if(r!==Y)throw new Error("invert: does not exist");return $(s,e)}function oe(t,e,n){if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root")}function sn(t,e){const n=(t.ORDER+Y)/Qe,r=t.pow(e,n);return oe(t,r,e),r}function Dr(t,e){const n=(t.ORDER-tn)/en,r=t.mul(e,yt),s=t.pow(r,n),o=t.mul(e,s),a=t.mul(t.mul(o,yt),s),i=t.mul(o,t.sub(a,t.ONE));return oe(t,i,e),i}function Rr(t){const e=ie(t),n=on(t),r=n(e,e.neg(e.ONE)),s=n(e,r),o=n(e,e.neg(r)),a=(t+Or)/nn;return(i,c)=>{let u=i.pow(c,a),d=i.mul(u,r);const f=i.mul(u,s),m=i.mul(u,o),v=i.eql(i.sqr(d),c),S=i.eql(i.sqr(f),c);u=i.cmov(u,d,v),d=i.cmov(m,f,S);const E=i.eql(i.sqr(d),c),b=i.cmov(u,d,E);return oe(i,b,c),b}}function on(t){if(t<Xe)throw new Error("sqrt is not defined for small field");let e=t-Y,n=0;for(;e%yt===G;)e/=yt,n++;let r=yt;const s=ie(t);for(;an(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return sn;let o=s.pow(r,e);const a=(e+Y)/yt;return function(c,u){if(c.is0(u))return u;if(an(c,u)!==1)throw new Error("Cannot find square root");let d=n,f=c.mul(c.ONE,o),m=c.pow(u,e),v=c.pow(u,a);for(;!c.eql(m,c.ONE);){if(c.is0(m))return c.ZERO;let S=1,E=c.sqr(m);for(;!c.eql(E,c.ONE);)if(S++,E=c.sqr(E),S===d)throw new Error("Cannot find square root");const b=Y<<BigInt(d-S-1),O=c.pow(f,b);d=S,f=c.sqr(O),m=c.mul(m,f),v=c.mul(v,O)}return v}}function Cr(t){return t%Qe===Xe?sn:t%en===tn?Dr:t%nn===Tr?Rr(t):on(t)}const Nr=(t,e)=>($(t,e)&Y)===Y,Pr=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Kr(t){const e={ORDER:"bigint",BYTES:"number",BITS:"number"},n=Pr.reduce((r,s)=>(r[s]="function",r),e);return se(t,n),t}function Ur(t,e,n){if(n<G)throw new Error("invalid exponent, negatives unsupported");if(n===G)return t.ONE;if(n===Y)return e;let r=t.ONE,s=e;for(;n>G;)n&Y&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Y;return r}function cn(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((a,i,c)=>t.is0(i)?a:(r[c]=a,t.mul(a,i)),t.ONE),o=t.inv(s);return e.reduceRight((a,i,c)=>t.is0(i)?a:(r[c]=t.mul(a,r[c]),t.mul(a,i)),o),r}function an(t,e){const n=(t.ORDER-Y)/yt,r=t.pow(e,n),s=t.eql(r,t.ONE),o=t.eql(r,t.ZERO),a=t.eql(r,t.neg(t.ONE));if(!s&&!o&&!a)throw new Error("invalid Legendre symbol result");return s?1:o?0:-1}function Mr(t,e){e!==void 0&&Qt(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}class Lr{constructor(e,n={}){l(this,"ORDER");l(this,"BITS");l(this,"BYTES");l(this,"isLE");l(this,"ZERO",G);l(this,"ONE",Y);l(this,"_lengths");l(this,"_sqrt");l(this,"_mod");var a;if(e<=G)throw new Error("invalid field: expected ORDER > 0, got "+e);let r;this.isLE=!1,n!=null&&typeof n=="object"&&(typeof n.BITS=="number"&&(r=n.BITS),typeof n.sqrt=="function"&&(this.sqrt=n.sqrt),typeof n.isLE=="boolean"&&(this.isLE=n.isLE),n.allowedLengths&&(this._lengths=(a=n.allowedLengths)==null?void 0:a.slice()),typeof n.modFromBytes=="boolean"&&(this._mod=n.modFromBytes));const{nBitLength:s,nByteLength:o}=Mr(e,r);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=e,this.BITS=s,this.BYTES=o,this._sqrt=void 0,Object.preventExtensions(this)}create(e){return $(e,this.ORDER)}isValid(e){if(typeof e!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof e);return G<=e&&e<this.ORDER}is0(e){return e===G}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}isOdd(e){return(e&Y)===Y}neg(e){return $(-e,this.ORDER)}eql(e,n){return e===n}sqr(e){return $(e*e,this.ORDER)}add(e,n){return $(e+n,this.ORDER)}sub(e,n){return $(e-n,this.ORDER)}mul(e,n){return $(e*n,this.ORDER)}pow(e,n){return Ur(this,e,n)}div(e,n){return $(e*rn(n,this.ORDER),this.ORDER)}sqrN(e){return e*e}addN(e,n){return e+n}subN(e,n){return e-n}mulN(e,n){return e*n}inv(e){return rn(e,this.ORDER)}sqrt(e){return this._sqrt||(this._sqrt=Cr(this.ORDER)),this._sqrt(this,e)}toBytes(e){return this.isLE?Sr(e,this.BYTES):Ye(e,this.BYTES)}fromBytes(e,n=!1){z(e);const{_lengths:r,BYTES:s,isLE:o,ORDER:a,_mod:i}=this;if(r){if(!r.includes(e.length)||e.length>s)throw new Error("Field.fromBytes: expected "+r+" bytes, got "+e.length);const u=new Uint8Array(s);u.set(e,o?0:u.length-e.length),e=u}if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);let c=o?Ht(e):vr(e);if(i&&(c=$(c,a)),!n&&!this.isValid(c))throw new Error("invalid field element: outside of range 0..ORDER");return c}invertBatch(e){return cn(this,e)}cmov(e,n,r){return r?n:e}}function ie(t,e={}){return new Lr(t,e)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zt=BigInt(0),ce=BigInt(1);function un(t,e){const n=e.negate();return t?n:e}function ae(t,e){const n=cn(t.Fp,e.map(r=>r.Z));return e.map((r,s)=>t.fromAffine(r.toAffine(n[s])))}function fn(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function ue(t,e){fn(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,o=Ir(t),a=BigInt(t);return{windows:n,windowSize:r,mask:o,maxNumber:s,shiftBy:a}}function ln(t,e,n){const{windowSize:r,mask:s,maxNumber:o,shiftBy:a}=n;let i=Number(t&s),c=t>>a;i>r&&(i-=o,c+=ce);const u=e*r,d=u+Math.abs(i)-1,f=i===0,m=i<0,v=e%2!==0;return{nextN:c,offset:d,isZero:f,isNeg:m,isNegF:v,offsetF:u}}const fe=new WeakMap,dn=new WeakMap;function le(t){return dn.get(t)||1}function hn(t){if(t!==zt)throw new Error("invalid wNAF")}class kr{constructor(e,n){l(this,"BASE");l(this,"ZERO");l(this,"Fn");l(this,"bits");this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=n}_unsafeLadder(e,n,r=this.ZERO){let s=e;for(;n>zt;)n&ce&&(r=r.add(s)),s=s.double(),n>>=ce;return r}precomputeWindow(e,n){const{windows:r,windowSize:s}=ue(n,this.bits),o=[];let a=e,i=a;for(let c=0;c<r;c++){i=a,o.push(i);for(let u=1;u<s;u++)i=i.add(a),o.push(i);a=i.double()}return o}wNAF(e,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let s=this.ZERO,o=this.BASE;const a=ue(e,this.bits);for(let i=0;i<a.windows;i++){const{nextN:c,offset:u,isZero:d,isNeg:f,isNegF:m,offsetF:v}=ln(r,i,a);r=c,d?o=o.add(un(m,n[v])):s=s.add(un(f,n[u]))}return hn(r),{p:s,f:o}}wNAFUnsafe(e,n,r,s=this.ZERO){const o=ue(e,this.bits);for(let a=0;a<o.windows&&r!==zt;a++){const{nextN:i,offset:c,isZero:u,isNeg:d}=ln(r,a,o);if(r=i,!u){const f=n[c];s=s.add(d?f.negate():f)}}return hn(r),s}getPrecomputes(e,n,r){let s=fe.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&(typeof r=="function"&&(s=r(s)),fe.set(n,s))),s}cached(e,n,r){const s=le(e);return this.wNAF(s,this.getPrecomputes(s,e,r),n)}unsafe(e,n,r,s){const o=le(e);return o===1?this._unsafeLadder(e,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,e,r),n,s)}createCache(e,n){fn(n,this.bits),dn.set(e,n),fe.delete(e)}hasCache(e){return le(e)!==1}}function gn(t,e,n){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Kr(e),e}else return ie(t,{isLE:n})}function qr(t,e,n={},r){if(r===void 0&&(r=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const c of["p","n","h"]){const u=e[c];if(!(typeof u=="bigint"&&u>zt))throw new Error(`CURVE.${c} must be positive bigint`)}const s=gn(e.p,n.Fp,r),o=gn(e.n,n.Fn,r),i=["Gx","Gy","a","d"];for(const c of i)if(!s.isValid(e[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:o}}function jr(t,e){return function(r){const s=t(r);return{secretKey:s,publicKey:e(s)}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ht=BigInt(0),H=BigInt(1),de=BigInt(2),$r=BigInt(8);function Hr(t,e,n,r){const s=t.sqr(n),o=t.sqr(r),a=t.add(t.mul(e.a,s),o),i=t.add(t.ONE,t.mul(e.d,t.mul(s,o)));return t.eql(a,i)}function Fr(t,e={}){const n=qr("edwards",t,e,e.FpFnLE),{Fp:r,Fn:s}=n;let o=n.CURVE;const{h:a}=o;se(e,{},{uvRatio:"function"});const i=de<<BigInt(s.BYTES*8)-H,c=O=>r.create(O),u=e.uvRatio||((O,y)=>{try{return{isValid:!0,value:r.sqrt(r.div(O,y))}}catch{return{isValid:!1,value:ht}}});if(!Hr(r,o,o.Gx,o.Gy))throw new Error("bad curve params: generator point");function d(O,y,g=!1){const _=g?H:ht;return Ge("coordinate "+O,y,_,i),y}function f(O){if(!(O instanceof S))throw new Error("EdwardsPoint expected")}const m=Je((O,y)=>{const{X:g,Y:_,Z:T}=O,M=O.is0();y==null&&(y=M?$r:r.inv(T));const L=c(g*y),w=c(_*y),x=r.mul(T,y);if(M)return{x:ht,y:H};if(x!==H)throw new Error("invZ was invalid");return{x:L,y:w}}),v=Je(O=>{const{a:y,d:g}=o;if(O.is0())throw new Error("bad point: ZERO");const{X:_,Y:T,Z:M,T:L}=O,w=c(_*_),x=c(T*T),B=c(M*M),N=c(B*B),P=c(w*y),k=c(B*c(P+x)),p=c(N+c(g*c(w*x)));if(k!==p)throw new Error("bad point: equation left != right (1)");const h=c(_*T),A=c(M*L);if(h!==A)throw new Error("bad point: equation left != right (2)");return!0}),b=class b{constructor(y,g,_,T){l(this,"X");l(this,"Y");l(this,"Z");l(this,"T");this.X=d("x",y),this.Y=d("y",g),this.Z=d("z",_,!0),this.T=d("t",T),Object.freeze(this)}static CURVE(){return o}static fromAffine(y){if(y instanceof b)throw new Error("extended point not allowed");const{x:g,y:_}=y||{};return d("x",g),d("y",_),new b(g,_,H,c(g*_))}static fromBytes(y,g=!1){const _=r.BYTES,{a:T,d:M}=o;y=re(z(y,_,"point")),ne(g,"zip215");const L=re(y),w=y[_-1];L[_-1]=w&-129;const x=Ht(L),B=g?i:r.ORDER;Ge("point.y",x,ht,B);const N=c(x*x),P=c(N-H),k=c(M*N-T);let{isValid:p,value:h}=u(P,k);if(!p)throw new Error("bad point: invalid y coordinate");const A=(h&H)===H,I=(w&128)!==0;if(!g&&h===ht&&I)throw new Error("bad point: x=0 and x_0=1");return I!==A&&(h=c(-h)),b.fromAffine({x:h,y:x})}static fromHex(y,g=!1){return b.fromBytes(Me(y),g)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(y=8,g=!0){return E.createCache(this,y),g||this.multiply(de),this}assertValidity(){v(this)}equals(y){f(y);const{X:g,Y:_,Z:T}=this,{X:M,Y:L,Z:w}=y,x=c(g*w),B=c(M*T),N=c(_*w),P=c(L*T);return x===B&&N===P}is0(){return this.equals(b.ZERO)}negate(){return new b(c(-this.X),this.Y,this.Z,c(-this.T))}double(){const{a:y}=o,{X:g,Y:_,Z:T}=this,M=c(g*g),L=c(_*_),w=c(de*c(T*T)),x=c(y*M),B=g+_,N=c(c(B*B)-M-L),P=x+L,k=P-w,p=x-L,h=c(N*k),A=c(P*p),I=c(N*p),D=c(k*P);return new b(h,A,D,I)}add(y){f(y);const{a:g,d:_}=o,{X:T,Y:M,Z:L,T:w}=this,{X:x,Y:B,Z:N,T:P}=y,k=c(T*x),p=c(M*B),h=c(w*_*P),A=c(L*N),I=c((T+M)*(x+B)-k-p),D=A-h,K=A+h,j=c(p-g*k),F=c(I*D),q=c(K*j),V=c(I*j),pt=c(D*K);return new b(F,q,pt,V)}subtract(y){return this.add(y.negate())}multiply(y){if(!s.isValidNot0(y))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:g,f:_}=E.cached(this,y,T=>ae(b,T));return ae(b,[g,_])[0]}multiplyUnsafe(y,g=b.ZERO){if(!s.isValid(y))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return y===ht?b.ZERO:this.is0()||y===H?this:E.unsafe(this,y,_=>ae(b,_),g)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return E.unsafe(this,o.n).is0()}toAffine(y){return m(this,y)}clearCofactor(){return a===H?this:this.multiplyUnsafe(a)}toBytes(){const{x:y,y:g}=this.toAffine(),_=r.toBytes(g);return _[_.length-1]|=y&H?128:0,_}toHex(){return ee(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}};l(b,"BASE",new b(o.Gx,o.Gy,H,c(o.Gx*o.Gy))),l(b,"ZERO",new b(ht,H,H,ht)),l(b,"Fp",r),l(b,"Fn",s);let S=b;const E=new kr(S,s.BITS);return S.BASE.precompute(8),S}function zr(t,e,n={}){if(typeof e!="function")throw new Error('"hash" function param is required');se(n,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r}=n,{BASE:s,Fp:o,Fn:a}=t,i=n.randomBytes||rr,c=n.adjustScalarBytes||(w=>w),u=n.domain||((w,x,B)=>{if(ne(B,"phflag"),x.length||B)throw new Error("Contexts/pre-hash are not supported");return w});function d(w){return a.create(Ht(w))}function f(w){const x=g.secretKey;z(w,g.secretKey,"secretKey");const B=z(e(w),2*x,"hashedSecretKey"),N=c(B.slice(0,x)),P=B.slice(x,2*x),k=d(N);return{head:N,prefix:P,scalar:k}}function m(w){const{head:x,prefix:B,scalar:N}=f(w),P=s.multiply(N),k=P.toBytes();return{head:x,prefix:B,scalar:N,point:P,pointBytes:k}}function v(w){return m(w).pointBytes}function S(w=Uint8Array.of(),...x){const B=Le(...x);return d(e(u(B,z(w,void 0,"context"),!!r)))}function E(w,x,B={}){w=z(w,void 0,"message"),r&&(w=r(w));const{prefix:N,scalar:P,pointBytes:k}=m(x),p=S(B.context,N,w),h=s.multiply(p).toBytes(),A=S(B.context,h,k,w),I=a.create(p+A*P);if(!a.isValid(I))throw new Error("sign failed: invalid s");const D=Le(h,a.toBytes(I));return z(D,g.signature,"result")}const b={zip215:!0};function O(w,x,B,N=b){const{context:P,zip215:k}=N,p=g.signature;w=z(w,p,"signature"),x=z(x,void 0,"message"),B=z(B,g.publicKey,"publicKey"),k!==void 0&&ne(k,"zip215"),r&&(x=r(x));const h=p/2,A=w.subarray(0,h),I=Ht(w.subarray(h,p));let D,K,j;try{D=t.fromBytes(B,k),K=t.fromBytes(A,k),j=s.multiplyUnsafe(I)}catch{return!1}if(!k&&D.isSmallOrder())return!1;const F=S(P,K.toBytes(),D.toBytes(),x);return K.add(D.multiplyUnsafe(F)).subtract(j).clearCofactor().is0()}const y=o.BYTES,g={secretKey:y,publicKey:y,signature:2*y,seed:y};function _(w=i(g.seed)){return z(w,g.seed,"seed")}function T(w){return Ne(w)&&w.length===a.BYTES}function M(w,x){try{return!!t.fromBytes(w,x)}catch{return!1}}const L={getExtendedPublicKey:m,randomSecretKey:_,isValidSecretKey:T,isValidPublicKey:M,toMontgomery(w){const{y:x}=t.fromBytes(w),B=g.publicKey,N=B===32;if(!N&&B!==57)throw new Error("only defined for 25519 and 448");const P=N?o.div(H+x,H-x):o.div(x-H,x+H);return o.toBytes(P)},toMontgomerySecret(w){const x=g.secretKey;z(w,x);const B=e(w.subarray(0,x));return c(B).subarray(0,x)}};return Object.freeze({keygen:jr(_,v),getPublicKey:v,sign:E,verify:O,utils:L,Point:t,lengths:g})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Wr=BigInt(1),pn=BigInt(2),Zr=BigInt(5),Vr=BigInt(8),he=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Yr={p:he,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Vr,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Gr(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),o=he,i=t*t%o*t%o,c=Q(i,pn,o)*i%o,u=Q(c,Wr,o)*t%o,d=Q(u,Zr,o)*u%o,f=Q(d,e,o)*d%o,m=Q(f,n,o)*f%o,v=Q(m,r,o)*m%o,S=Q(v,s,o)*v%o,E=Q(S,s,o)*v%o,b=Q(E,e,o)*d%o;return{pow_p_5_8:Q(b,pn,o)*t%o,b2:i}}function Jr(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const yn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Xr(t,e){const n=he,r=$(e*e*e,n),s=$(r*r*e,n),o=Gr(t*s).pow_p_5_8;let a=$(t*r*o,n);const i=$(e*a*a,n),c=a,u=$(a*yn,n),d=i===t,f=i===$(-t,n),m=i===$(-t*yn,n);return d&&(a=c),(f||m)&&(a=u),Nr(a,n)&&(a=$(-a,n)),{isValid:d||f,value:a}}const Qr=Fr(Yr,{uvRatio:Xr});function ts(t){return zr(Qr,Er,Object.assign({adjustScalarBytes:Jr},t))}const wn=ts({}),Kt="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";function Ut(t){if(!t||typeof t!="string")throw new Error(`Expected base58 string but got “${t}”`);if(t.match(/[IOl0]/gmu))throw new Error(`Invalid base58 character “${t.match(/[IOl0]/gmu)}”`);const e=t.match(/^1+/gmu),n=e?e[0].length:0,r=(t.length-n)*(Math.log(58)/Math.log(256))+1>>>0;return new Uint8Array([...new Uint8Array(n),...t.match(/.{1}/gmu).map(s=>Kt.indexOf(s)).reduce((s,o)=>(s=s.map(a=>{const i=a*58+o;return o=i>>8,i}),s),new Uint8Array(r)).reverse().filter((s=>o=>s=s||o)(!1))])}const es=(()=>{const t=Array(256).fill(-1);for(let e=0;e<Kt.length;++e)t[Kt.charCodeAt(e)]=e;return t})();function bn(t){const e=[];for(const n of t){let r=n;for(let s=0;s<e.length;++s){const o=(es[e[s]]<<8)+r;e[s]=Kt.charCodeAt(o%58),r=o/58|0}for(;r;)e.push(Kt.charCodeAt(r%58)),r=r/58|0}for(const n of t){if(n)break;e.push(49)}return e.reverse(),String.fromCharCode(...e)}var ns=20,rs=1,wt=1e6,xn=1e6,ss=-7,os=21,is=!1,Mt="[big.js] ",bt=Mt+"Invalid ",Wt=bt+"decimal places",cs=bt+"rounding mode",mn=Mt+"Division by zero",R={},tt=void 0,as=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function _n(){function t(e){var n=this;if(!(n instanceof t))return e===tt&&arguments.length===0?_n():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(bt+"value");e=e===0&&1/e<0?"-0":String(e)}us(n,e)}n.constructor=t}return t.prototype=R,t.DP=ns,t.RM=rs,t.NE=ss,t.PE=os,t.strict=is,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function us(t,e){var n,r,s;if(!as.test(e))throw Error(bt+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function xt(t,e,n,r){var s=t.c;if(n===tt&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(cs);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==tt))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==tt||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function mt(t,e,n){var r=t.e,s=t.c.join(""),o=s.length;if(e)s=s.charAt(0)+(o>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>o)for(r-=o;r--;)s+="0";else r<o&&(s=s.slice(0,r)+"."+s.slice(r));else o>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}R.abs=function(){var t=new this.constructor(this);return t.s=1,t},R.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,o=n.s,a=t.s,i=n.e,c=t.e;if(!r[0]||!s[0])return r[0]?o:s[0]?-a:0;if(o!=a)return o;if(e=o<0,i!=c)return i>c^e?1:-1;for(a=(i=r.length)<(c=s.length)?i:c,o=-1;++o<a;)if(r[o]!=s[o])return r[o]>s[o]^e?1:-1;return i==c?0:i>c^e?1:-1},R.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,o=e.s==t.s?1:-1,a=n.DP;if(a!==~~a||a<0||a>wt)throw Error(Wt);if(!s[0])throw Error(mn);if(!r[0])return t.s=o,t.c=[t.e=0],t;var i,c,u,d,f,m=s.slice(),v=i=s.length,S=r.length,E=r.slice(0,i),b=E.length,O=t,y=O.c=[],g=0,_=a+(O.e=e.e-t.e)+1;for(O.s=o,o=_<0?0:_,m.unshift(0);b++<i;)E.push(0);do{for(u=0;u<10;u++){if(i!=(b=E.length))d=i>b?1:-1;else for(f=-1,d=0;++f<i;)if(s[f]!=E[f]){d=s[f]>E[f]?1:-1;break}if(d<0){for(c=b==i?s:m;b;){if(E[--b]<c[b]){for(f=b;f&&!E[--f];)E[f]=9;--E[f],E[b]+=10}E[b]-=c[b]}for(;!E[0];)E.shift()}else break}y[g++]=d?u:++u,E[0]&&d?E[b]=r[v]||0:E=[r[v]]}while((v++<S||E[0]!==tt)&&o--);return!y[0]&&g!=1&&(y.shift(),O.e--,_--),g>_&&xt(O,_,n.RM,E[0]!==tt),O},R.eq=function(t){return this.cmp(t)===0},R.gt=function(t){return this.cmp(t)>0},R.gte=function(t){return this.cmp(t)>-1},R.lt=function(t){return this.cmp(t)<0},R.lte=function(t){return this.cmp(t)<1},R.minus=R.sub=function(t){var e,n,r,s,o=this,a=o.constructor,i=o.s,c=(t=new a(t)).s;if(i!=c)return t.s=-c,o.plus(t);var u=o.c.slice(),d=o.e,f=t.c,m=t.e;if(!u[0]||!f[0])return f[0]?t.s=-c:u[0]?t=new a(o):t.s=1,t;if(i=d-m){for((s=i<0)?(i=-i,r=u):(m=d,r=f),r.reverse(),c=i;c--;)r.push(0);r.reverse()}else for(n=((s=u.length<f.length)?u:f).length,i=c=0;c<n;c++)if(u[c]!=f[c]){s=u[c]<f[c];break}if(s&&(r=u,u=f,f=r,t.s=-t.s),(c=(n=f.length)-(e=u.length))>0)for(;c--;)u[e++]=0;for(c=e;n>i;){if(u[--n]<f[n]){for(e=n;e&&!u[--e];)u[e]=9;--u[e],u[n]+=10}u[n]-=f[n]}for(;u[--c]===0;)u.pop();for(;u[0]===0;)u.shift(),--m;return u[0]||(t.s=1,u=[m=0]),t.c=u,t.e=m,t},R.mod=function(t){var e,n=this,r=n.constructor,s=n.s,o=(t=new r(t)).s;if(!t.c[0])throw Error(mn);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=o,e?new r(n):(s=r.DP,o=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=o,this.minus(n.times(t)))},R.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t},R.plus=R.add=function(t){var e,n,r,s=this,o=s.constructor;if(t=new o(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var a=s.e,i=s.c,c=t.e,u=t.c;if(!i[0]||!u[0])return u[0]||(i[0]?t=new o(s):t.s=s.s),t;if(i=i.slice(),e=a-c){for(e>0?(c=a,r=u):(e=-e,r=i),r.reverse();e--;)r.push(0);r.reverse()}for(i.length-u.length<0&&(r=u,u=i,i=r),e=u.length,n=0;e;i[e]%=10)n=(i[--e]=i[e]+u[e]+n)/10|0;for(n&&(i.unshift(n),++c),e=i.length;i[--e]===0;)i.pop();return t.c=i,t.e=c,t},R.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-xn||t>xn)throw Error(bt+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r},R.prec=function(t,e){if(t!==~~t||t<1||t>wt)throw Error(bt+"precision");return xt(new this.constructor(this),t,e)},R.round=function(t,e){if(t===tt)t=0;else if(t!==~~t||t<-wt||t>wt)throw Error(Wt);return xt(new this.constructor(this),t+this.e+1,e)},R.sqrt=function(){var t,e,n,r=this,s=r.constructor,o=r.s,a=r.e,i=new s("0.5");if(!r.c[0])return new s(r);if(o<0)throw Error(Mt+"No square root");o=Math.sqrt(+mt(r,!0,!0)),o===0||o===1/0?(e=r.c.join(""),e.length+a&1||(e+="0"),o=Math.sqrt(e),a=((a+1)/2|0)-(a<0||a&1),t=new s((o==1/0?"5e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):t=new s(o+""),a=t.e+(s.DP+=4);do n=t,t=i.times(n.plus(r.div(n)));while(n.c.slice(0,a).join("")!==t.c.slice(0,a).join(""));return xt(t,(s.DP-=4)+t.e+1,s.RM)},R.times=R.mul=function(t){var e,n=this,r=n.constructor,s=n.c,o=(t=new r(t)).c,a=s.length,i=o.length,c=n.e,u=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!o[0])return t.c=[t.e=0],t;for(t.e=c+u,a<i&&(e=s,s=o,o=e,u=a,a=i,i=u),e=new Array(u=a+i);u--;)e[u]=0;for(c=i;c--;){for(i=0,u=a+c;u>c;)i=e[u]+o[c]*s[u-c-1]+i,e[u--]=i%10,i=i/10|0;e[u]=i}for(i?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t},R.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==tt){if(t!==~~t||t<0||t>wt)throw Error(Wt);for(n=xt(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return mt(n,!0,!!r)},R.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==tt){if(t!==~~t||t<0||t>wt)throw Error(Wt);for(n=xt(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return mt(n,!1,!!r)},R.toJSON=R.toString=function(){var t=this,e=t.constructor;return mt(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])},typeof Symbol<"u"&&(R[Symbol.for("nodejs.util.inspect.custom")]=R.toJSON),R.toNumber=function(){var t=+mt(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(Mt+"Imprecise conversion");return t},R.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==tt){if(t!==~~t||t<1||t>wt)throw Error(bt+"precision");for(n=xt(new r(n),t,e);n.c.length<t;)n.c.push(0)}return mt(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)},R.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(Mt+"valueOf disallowed");return mt(t,t.e<=e.NE||t.e>=e.PE,!0)};var et=_n();const Bt=typeof Buffer=="function",En=typeof TextDecoder=="function"?new TextDecoder:void 0,An=typeof TextEncoder=="function"?new TextEncoder:void 0,Lt=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Zt=(t=>{let e={};return t.forEach((n,r)=>e[n]=r),e})(Lt),fs=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,W=String.fromCharCode.bind(String),vn=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),Sn=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),Bn=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),In=typeof btoa=="function"?t=>btoa(t):Bt?t=>Buffer.from(t,"binary").toString("base64"):t=>{let e,n,r,s,o="";const a=t.length%3;for(let i=0;i<t.length;){if((n=t.charCodeAt(i++))>255||(r=t.charCodeAt(i++))>255||(s=t.charCodeAt(i++))>255)throw new TypeError("invalid character found");e=n<<16|r<<8|s,o+=Lt[e>>18&63]+Lt[e>>12&63]+Lt[e>>6&63]+Lt[e&63]}return a?o.slice(0,a-3)+"===".substring(a):o},ge=Bt?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let r=0,s=t.length;r<s;r+=4096)n.push(W.apply(null,t.subarray(r,r+4096)));return In(n.join(""))},ls=(t,e=!1)=>e?Sn(ge(t)):ge(t),ds=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?W(192|e>>>6)+W(128|e&63):W(224|e>>>12&15)+W(128|e>>>6&63)+W(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return W(240|e>>>18&7)+W(128|e>>>12&63)+W(128|e>>>6&63)+W(128|e&63)}},hs=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,gs=t=>t.replace(hs,ds),On=Bt?t=>Buffer.from(t,"utf8").toString("base64"):An?t=>ge(An.encode(t)):t=>In(gs(t)),ps=(t,e=!1)=>e?Sn(On(t)):On(t),ys=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,ws=t=>{switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return W((n>>>10)+55296)+W((n&1023)+56320);case 3:return W((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return W((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},bs=t=>t.replace(ys,ws),Tn=typeof atob=="function"?t=>atob(Bn(t)):Bt?t=>Buffer.from(t,"base64").toString("binary"):t=>{if(t=t.replace(/\s+/g,""),!fs.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,n,r,s=[];for(let o=0;o<t.length;)e=Zt[t.charAt(o++)]<<18|Zt[t.charAt(o++)]<<12|(n=Zt[t.charAt(o++)])<<6|(r=Zt[t.charAt(o++)]),n===64?s.push(W(e>>16&255)):r===64?s.push(W(e>>16&255,e>>8&255)):s.push(W(e>>16&255,e>>8&255,e&255));return s.join("")},Dn=Bt?t=>vn(Buffer.from(t,"base64")):t=>vn(Tn(t).split("").map(e=>e.charCodeAt(0))),xs=t=>Dn(Rn(t)),ms=Bt?t=>Buffer.from(t,"base64").toString("utf8"):En?t=>En.decode(Dn(t)):t=>bs(Tn(t)),Rn=t=>Bn(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),_s=t=>ms(Rn(t));var Es=Object.defineProperty,nt=(t,e)=>Es(t,"name",{value:e,configurable:!0});const pe="__fastnear_",As=nt(()=>typeof localStorage<"u"?localStorage:{getItem:nt(t=>Vt.get(t)||null,"getItem"),setItem:nt((t,e)=>Vt.set(t,e),"setItem"),removeItem:nt(t=>Vt.delete(t),"removeItem"),clear:nt(()=>Vt.clear(),"clear")},"createDefaultStorage"),Vt=new Map;let It=As();const Cn={setBackend:nt(t=>{It=t},"setBackend"),set:nt((t,e)=>{e==null?It.removeItem(pe+t):It.setItem(pe+t,JSON.stringify(e))},"set"),get:nt(t=>{const e=It.getItem(pe+t);if(e===null)return null;try{return JSON.parse(e)}catch{return e}},"get"),remove:nt(t=>It.removeItem(t),"remove"),clear:nt(()=>It.clear(),"clear")};var vs=Object.defineProperty,J=(t,e)=>vs(t,"name",{value:e,configurable:!0});function Ss(t){return Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("")}J(Ss,"toHex");function Bs(t){if(t.length%2)throw new Error("Hex string must be even length");const e=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)e[n/2]=parseInt(t.slice(n,n+2),16);return e}J(Bs,"fromHex");function ye(t){return xs(t)}J(ye,"base64ToBytes");function Yt(t){return ls(t)}J(Yt,"bytesToBase64");function Is(t){try{return ps(t)}catch(e){return console.error("Issue base64 encoding",e),null}}J(Is,"toBase64");function Os(t){try{return _s(t)}catch(e){return console.error("Issue base64 decoding",e),null}}J(Os,"fromBase64");function Ts(t,...e){if(Array.isArray(t)&&(t=t.reduce((n,r,s)=>n+(e[s-1]??"")+r)),typeof t=="string"){const n=t.match(/([0-9.,_]+)\s*([a-zA-Z]+)?/);if(n){const r=n[1].replace(/[_,]/g,""),s=n[2];if(s)switch(s.toLowerCase()){case"near":return et(r).mul(et(10).pow(24)).toFixed(0);case"tgas":return et(r).mul(et(10).pow(12)).toFixed(0);case"ggas":return et(r).mul(et(10).pow(9)).toFixed(0);case"gas":case"yoctonear":return et(r).toFixed(0);default:throw new Error(`Unknown unit: ${s}`)}else return et(r).toFixed(0)}}return et(`${t}`).toFixed(0)}J(Ts,"convertUnit");function Ds(t,e){Cn.set(t,e)}J(Ds,"lsSet");function Rs(t){return Cn.get(t)}J(Rs,"lsGet");function Cs(t){return JSON.parse(JSON.stringify(t))}J(Cs,"deepCopy");function Ns(...t){try{return JSON.parse(t[0])}catch{return t.length>1?t[1]:t[0]}}J(Ns,"tryParseJson");function Ps(t){try{const e=new TextDecoder;return JSON.parse(e.decode(t instanceof Uint8Array?t:new Uint8Array(t)))}catch{try{return t instanceof Uint8Array?t:new Uint8Array(t)}catch{return t}}}J(Ps,"parseJsonFromBytes");function Ks(t){var e;return t.length===1&&t[0].type==="FunctionCall"&&et(((e=t[0])==null?void 0:e.deposit)??"0").eq(0)}J(Ks,"canSignWithLAK");var Us=Object.defineProperty,Ot=(t,e)=>Us(t,"name",{value:e,configurable:!0});const Tt=Ot(t=>Ut(t.includes(":")?(()=>{const[e,n]=t.split(":");if(e!=="ed25519")throw new Error(`Unsupported curve: ${e}`);return n})():t),"keyFromString"),Nn=Ot(t=>`ed25519:${bn(t)}`,"keyToString");function Pn(t){const e=Tt(t).slice(0,32),n=wn.getPublicKey(e);return Nn(n)}Ot(Pn,"publicKeyFromPrivate");function Kn(){const t=crypto.getRandomValues(new Uint8Array(64));return Nn(t)}Ot(Kn,"privateKeyFromRandom");function Un(t,e,n){const r=Tt(e).slice(0,32),s=wn.sign(t,r);return n!=null&&n.returnBase58?bn(s):s}Ot(Un,"signHash");function Ms(t,e){const n=_r(t);return Un(n,e)}Ot(Ms,"signBytes");var Ls=Object.defineProperty,Mn=(t,e)=>Ls(t,"name",{value:e,configurable:!0});const ks=new(Nt=class{constructor(){l(this,"Ed25519Signature",{struct:{data:{array:{type:"u8",len:64}}}});l(this,"Secp256k1Signature",{struct:{data:{array:{type:"u8",len:65}}}});l(this,"Signature",{enum:[{struct:{ed25519Signature:this.Ed25519Signature}},{struct:{secp256k1Signature:this.Secp256k1Signature}}]});l(this,"Ed25519Data",{struct:{data:{array:{type:"u8",len:32}}}});l(this,"Secp256k1Data",{struct:{data:{array:{type:"u8",len:64}}}});l(this,"PublicKey",{enum:[{struct:{ed25519Key:this.Ed25519Data}},{struct:{secp256k1Key:this.Secp256k1Data}}]});l(this,"FunctionCallPermission",{struct:{allowance:{option:"u128"},receiverId:"string",methodNames:{array:{type:"string"}}}});l(this,"FullAccessPermission",{struct:{}});l(this,"AccessKeyPermission",{enum:[{struct:{functionCall:this.FunctionCallPermission}},{struct:{fullAccess:this.FullAccessPermission}}]});l(this,"AccessKey",{struct:{nonce:"u64",permission:this.AccessKeyPermission}});l(this,"CreateAccount",{struct:{}});l(this,"DeployContract",{struct:{code:{array:{type:"u8"}}}});l(this,"FunctionCall",{struct:{methodName:"string",args:{array:{type:"u8"}},gas:"u64",deposit:"u128"}});l(this,"Transfer",{struct:{deposit:"u128"}});l(this,"Stake",{struct:{stake:"u128",publicKey:this.PublicKey}});l(this,"AddKey",{struct:{publicKey:this.PublicKey,accessKey:this.AccessKey}});l(this,"DeleteKey",{struct:{publicKey:this.PublicKey}});l(this,"DeleteAccount",{struct:{beneficiaryId:"string"}});l(this,"ClassicAction",{enum:[{struct:{createAccount:this.CreateAccount}},{struct:{deployContract:this.DeployContract}},{struct:{functionCall:this.FunctionCall}},{struct:{transfer:this.Transfer}},{struct:{stake:this.Stake}},{struct:{addKey:this.AddKey}},{struct:{deleteKey:this.DeleteKey}},{struct:{deleteAccount:this.DeleteAccount}}]});l(this,"DelegateAction",{struct:{senderId:"string",receiverId:"string",actions:{array:{type:this.ClassicAction}},nonce:"u64",maxBlockHeight:"u64",publicKey:this.PublicKey}});l(this,"SignedDelegate",{struct:{delegateAction:this.DelegateAction,signature:this.Signature}});l(this,"Action",{enum:[{struct:{createAccount:this.CreateAccount}},{struct:{deployContract:this.DeployContract}},{struct:{functionCall:this.FunctionCall}},{struct:{transfer:this.Transfer}},{struct:{stake:this.Stake}},{struct:{addKey:this.AddKey}},{struct:{deleteKey:this.DeleteKey}},{struct:{deleteAccount:this.DeleteAccount}},{struct:{signedDelegate:this.SignedDelegate}}]});l(this,"Transaction",{struct:{signerId:"string",publicKey:this.PublicKey,nonce:"u64",receiverId:"string",blockHash:{array:{type:"u8",len:32}},actions:{array:{type:this.Action}}}});l(this,"SignedTransaction",{struct:{transaction:this.Transaction,signature:this.Signature}})}},Mn(Nt,"BorshSchema"),Nt),qs=Mn(()=>ks,"getBorshSchema");var js=Object.defineProperty,Gt=(t,e)=>js(t,"name",{value:e,configurable:!0});function Jt(t){return{signerId:t.signerId,publicKey:{ed25519Key:{data:Tt(t.publicKey)}},nonce:BigInt(t.nonce),receiverId:t.receiverId,blockHash:Ut(t.blockHash),actions:t.actions.map(we)}}Gt(Jt,"mapTransaction");function $s(t){console.log("fastnear: serializing transaction");const e=Jt(t);return console.log("fastnear: mapped transaction for borsh:",e),Xt(be.Transaction,e)}Gt($s,"serializeTransaction");function Hs(t,e){console.log("fastnear: Serializing Signed Transaction",t),console.log("fastnear: signature",e),console.log("fastnear: signature length",Ut(e).length);const n=Jt(t);console.log("fastnear: mapped (for borsh schema) signed transaction",n);const r={transaction:n,signature:{ed25519Signature:{data:Ut(e)}}},s=Xt(be.SignedTransaction,r,!0);return console.log("fastnear: borsh-serialized signed transaction:",s),s}Gt(Hs,"serializeSignedTransaction");function we(t){switch(t.type){case"CreateAccount":return{createAccount:{}};case"DeployContract":return{deployContract:{code:ye(t.codeBase64)}};case"FunctionCall":return{functionCall:{methodName:t.methodName,args:t.argsBase64!==null&&t.argsBase64!==void 0?ye(t.argsBase64):new TextEncoder().encode(JSON.stringify(t.args)),gas:BigInt(t.gas??"300000000000000"),deposit:BigInt(t.deposit??"0")}};case"Transfer":return{transfer:{deposit:BigInt(t.deposit)}};case"Stake":return{stake:{stake:BigInt(t.stake),publicKey:{ed25519Key:{data:Tt(t.publicKey)}}}};case"AddKey":return{addKey:{publicKey:{ed25519Key:{data:Tt(t.publicKey)}},accessKey:{nonce:BigInt(t.accessKey.nonce),permission:t.accessKey.permission==="FullAccess"?{fullAccess:{}}:{functionCall:{allowance:t.accessKey.allowance?BigInt(t.accessKey.allowance):null,receiverId:t.accessKey.receiverId,methodNames:t.accessKey.methodNames}}}}};case"DeleteKey":return{deleteKey:{publicKey:{ed25519Key:{data:Tt(t.publicKey)}}}};case"DeleteAccount":return{deleteAccount:{beneficiaryId:t.beneficiaryId}};case"SignedDelegate":return{signedDelegate:{delegateAction:we(t.delegateAction),signature:{ed25519Signature:Ut(t.signature)}}};default:throw new Error("Not implemented action: "+t.type)}}Gt(we,"mapAction");const be=qs();var Fs=Object.defineProperty,Ln=(t,e)=>Fs(t,"name",{value:e,configurable:!0});const zs=Ln(t=>{if(typeof t=="string")return t;if(t instanceof Uint8Array)return Yt(t);if(Array.isArray(t))return Yt(Uint8Array.from(t));throw new Error("DeployContract code must be Uint8Array, Array<number>, or base64 string")},"toBase64Code"),Ws=Ln(t=>t.map(e=>{var n,r,s,o,a,i,c,u,d,f,m,v,S,E,b,O,y,g,_,T,M,L,w,x;if(typeof e!="object"||e==null)throw new Error("Invalid action");if(!("type"in e)||typeof e.type!="string")throw new Error("Action is missing type");switch(e.type){case"FunctionCall":return{type:"FunctionCall",methodName:(n=e.params)==null?void 0:n.methodName,args:((r=e.params)==null?void 0:r.args)??{},gas:((s=e.params)==null?void 0:s.gas)??"30000000000000",deposit:((o=e.params)==null?void 0:o.deposit)??"0"};case"Transfer":return{type:"Transfer",deposit:(a=e.params)==null?void 0:a.deposit};case"AddKey":return{type:"AddKey",publicKey:(i=e.params)==null?void 0:i.publicKey,accessKey:{nonce:((u=(c=e.params)==null?void 0:c.accessKey)==null?void 0:u.nonce)??0,permission:((f=(d=e.params)==null?void 0:d.accessKey)==null?void 0:f.permission)==="FullAccess"?"FullAccess":{receiverId:(S=(v=(m=e.params)==null?void 0:m.accessKey)==null?void 0:v.permission)==null?void 0:S.receiverId,methodNames:((O=(b=(E=e.params)==null?void 0:E.accessKey)==null?void 0:b.permission)==null?void 0:O.methodNames)??[],allowance:(_=(g=(y=e.params)==null?void 0:y.accessKey)==null?void 0:g.permission)==null?void 0:_.allowance}}};case"DeleteKey":return{type:"DeleteKey",publicKey:(T=e.params)==null?void 0:T.publicKey};case"CreateAccount":return{type:"CreateAccount"};case"DeleteAccount":return{type:"DeleteAccount",beneficiaryId:(M=e.params)==null?void 0:M.beneficiaryId};case"DeployContract":return{type:"DeployContract",codeBase64:zs((L=e.params)==null?void 0:L.code)};case"Stake":return{type:"Stake",stake:(w=e.params)==null?void 0:w.stake,publicKey:(x=e.params)==null?void 0:x.publicKey};default:throw new Error(`Unsupported action type: ${e.type}`)}}),"connectorActionsToFastnearActions");var Zs=Object.defineProperty,kn=(t,e)=>Zs(t,"name",{value:e,configurable:!0});const Se=class Se extends Error{constructor(n,r,s){super(r);l(this,"code");l(this,"cause");l(this,"details");this.name="TransportError",this.code=n,this.cause=s==null?void 0:s.cause,this.details=s==null?void 0:s.details}};kn(Se,"TransportError");let U=Se;const Be=class Be extends Error{constructor(n,r,s){super(r);l(this,"code");l(this,"cause");l(this,"details");this.name="UserRejectedError",this.code=n,this.cause=s==null?void 0:s.cause,this.details=s==null?void 0:s.details}};kn(Be,"UserRejectedError");let Dt=Be;var Vs=Object.defineProperty,xe=(t,e)=>Vs(t,"name",{value:e,configurable:!0});const qn={mainnet:["https://relmn.aurora.dev","https://nearrpc.aurora.dev","https://rpc.mainnet.near.org"],testnet:["https://rpc.testnet.near.org"]},Ys=xe(t=>new Promise(e=>setTimeout(e,t)),"wait");let Gs=1e3;const Ie=class Ie{constructor(e,n=3e4){l(this,"providers");l(this,"index",0);l(this,"timeoutMs");l(this,"startTimeoutMs");this.providers=e.length>0?e:qn.mainnet,this.timeoutMs=n,this.startTimeoutMs=n}async block(e){return this.sendJsonRpc("block",e)}async query(e){return this.sendJsonRpc("query",e)}async txStatus(e,n,r){return this.sendJsonRpc("tx",{tx_hash:e,sender_account_id:n,wait_until:r})}async sendJsonRpc(e,n,r=0){const s=this.providers[this.index];try{const o=await this.send(s,e,n,this.timeoutMs);return this.timeoutMs=Math.max(this.startTimeoutMs,Math.floor(this.timeoutMs/1.2)),o}catch(o){const a=r+1>=this.providers.length*3;if(this.index=(this.index+1)%this.providers.length,this.timeoutMs=Math.min(6e4,Math.floor(this.timeoutMs*1.2)),a)throw o;return await Ys(Math.min(500*(r+1),3e3)),this.sendJsonRpc(e,n,r+1)}}async send(e,n,r,s){const o=new AbortController,a=setTimeout(()=>o.abort(),s);try{const i=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:Gs++,method:n,params:r}),signal:o.signal});if(!i.ok){const u=await i.text().catch(()=>"Unknown RPC error");throw new U("RPC_HTTP_ERROR",`RPC request failed (${i.status}): ${u}`)}const c=await i.json();if(c.error){const u=typeof c.error.data=="string"?c.error.data:c.error.message??"RPC error";throw new U("RPC_RESPONSE_ERROR",u,{details:c.error})}return c.result}catch(i){throw o.signal.aborted?new U("RPC_TIMEOUT","RPC request timed out",{cause:i}):i instanceof U?i:new U("RPC_NETWORK_ERROR","RPC network request failed",{cause:i})}finally{clearTimeout(a)}}};xe(Ie,"NearRpcClient");let me=Ie;const Js=xe(t=>{const e={};return n=>{if(e[n]!=null)return e[n];const r=t==null?void 0:t(n);return e[n]=new me(r&&r.length>0?r:qn[n]),e[n]}},"createRpcFactory");var Xs=Object.defineProperty,rt=(t,e)=>Xs(t,"name",{value:e,configurable:!0});const Qs=rt(()=>typeof window<"u"&&window.localStorage!=null,"isStorageAvailable"),to=rt(()=>{if(!Qs()){const t=new Map;return{get:rt(e=>t.get(e)??null,"get"),set:rt((e,n)=>{t.set(e,n)},"set"),remove:rt(e=>{t.delete(e)},"remove")}}return{get:rt(t=>window.localStorage.getItem(t),"get"),set:rt((t,e)=>window.localStorage.setItem(t,e),"set"),remove:rt(t=>window.localStorage.removeItem(t),"remove")}},"createDefaultStorage"),_e=rt(async(t,e,n)=>{try{const r=await t.get(e);return r==null?n:JSON.parse(r)}catch{return n}},"readJson"),Ee=rt(async(t,e,n)=>{await t.set(e,JSON.stringify(n))},"writeJson");var eo=Object.defineProperty,C=(t,e)=>eo(t,"name",{value:e,configurable:!0});const no="https://wallet.meteorwallet.app",ro=450,Ae=390,ve=650,jn="_meteor_wallet_auth_key",so=C(()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`meteor-${Date.now()}-${Math.floor(Math.random()*1e5)}`,"randomUid"),$n=C(()=>{if(typeof window>"u"||window.top==null)return`popup=1,width=${Ae},height=${ve}`;const t=window.top.outerHeight/2+window.top.screenY-ve/2,e=window.top.outerWidth/2+window.top.screenX-Ae/2;return`popup=1,width=${Ae},height=${ve},top=${t},left=${e}`},"popupFeatures"),oo=C(t=>t==="USER_CANCELLED"||t==="WINDOW_CLOSED"||t==="INCOMPLETE_ACTION","isUserRejectedTag"),io=C((t,e)=>{const n=e??[],r=n[n.length-1];return oo(r)?new Dt(r??"USER_REJECTED",t,{details:{endTags:n}}):r==="POPUP_WINDOW_OPEN_FAILED"||r==="POPUP_WINDOW_REFUSED"?new U(r,t,{details:{endTags:n}}):new U(r??"METEOR_ACTION_FAILED",t,{details:{endTags:n}})},"mapMeteorError"),Rt=C(t=>{if(t!=="mainnet"&&t!=="testnet")throw new U("INVALID_NETWORK",`Unsupported network: ${t}`);return t},"ensureNetwork"),co=C(t=>{const e=Xt(be.Transaction,Jt(t));return Yt(new Uint8Array(e))},"toMeteorTxPayload"),kt=C(t=>t instanceof U||t instanceof Dt?t:t instanceof Error?new U("METEOR_ACTION_FAILED",t.message,{cause:t}):new U("METEOR_ACTION_FAILED","Meteor action failed",{details:t}),"normalizeActionError"),ao=C((t={})=>{const e=t.storage??to(),n=t.walletBaseUrl??no,r=t.appKeyPrefix??"near_app",s=t.openWindow??((p,h,A)=>typeof window>"u"?null:window.open(p,h??"MeteorWallet",A??$n())),o=Js(t.getNetworkProviders),a=new URL(n).origin,i=C(p=>`${r}${jn}:${p}`,"authStorageKey"),c=`${r}${jn}`;let u=!1,d=null;const f=C(async p=>{var A;const h=await _e(e,i(p),{allKeys:[]});return h.accountId||(((A=h.allKeys)==null?void 0:A.length)??0)>0?h:_e(e,c,{allKeys:[]})},"loadAuth"),m=C(async(p,h)=>{await Ee(e,i(p),h),await Ee(e,c,h)},"saveAuth"),v=C(async p=>{await e.remove(i(p))},"clearAuth"),S=C(()=>{var p,h;d!=null&&(d.interval!=null&&clearInterval(d.interval),d.cleanupFns.forEach(A=>A()),d.cleanupFns=[],(h=(p=d.popup)==null?void 0:p.close)==null||h.call(p),d=null)},"cleanupConnection"),E=C(p=>{var A;const h={uid:p.uid,actionType:p.actionType,status:p.status,network:p.network,endTags:[]};if(p.status==="initializing"&&(h.inputs=p.inputs),p.extension!=null){p.extension.sendMessageData(h);return}if(((A=p.popup)==null?void 0:A.postMessage)!=null)try{p.popup.postMessage(h,p.walletOrigin)}catch{p.popup.postMessage(h)}},"sendConnectionMessage"),b=C(p=>{if(d==null)return;const h=d.reject;S(),h(p)},"closeWithError"),O=C(p=>{if(d==null)return;const h=d.resolve;S(),h(p)},"closeWithSuccess"),y=C(p=>{const h=p;if(d!=null&&h.uid===d.uid&&h.status!=null){if(h.status==="attempting_reconnect"){d.status="initializing",E(d);return}if(h.status==="connected"&&d.status==="initializing"){d.status="connected";return}if(h.status==="closed_success"){O(h.payload);return}if(h.status==="closed_fail"){b(io(h.message??"Meteor action failed",h.endTags));return}if(h.status==="closed_window"){b(new Dt("WINDOW_CLOSED",h.message??"User closed the wallet window",{details:{endTags:h.endTags??["WINDOW_CLOSED"]}}));return}h.status==="disconnected"&&b(new U("DISCONNECTED","Meteor wallet transport disconnected"))}},"handleMeteorResponse"),g=C(p=>{p==null||u||(p.addMessageDataListener(h=>y(h)),u=!0)},"attachExtensionListenerIfNeeded"),_=C(async(p,h,A)=>{var F;d!=null&&(d.reject(new U("NEW_ACTION_STARTED","A new action was started before the previous action completed")),S());const I=so(),D=(F=t.getExtensionBridge)==null?void 0:F.call(t);g(D);let K;const j=[];if(D==null){const q=new URL(`${n}/connect/${p}/${h}`);if(q.searchParams.set("source","wpm"),q.searchParams.set("connectionUid",I),K=s(q.toString(),"MeteorWallet",$n())??void 0,K==null)throw new U("POPUP_WINDOW_OPEN_FAILED","Couldn't open popup window to complete wallet action");if(K.windowIdPromise!=null&&await K.windowIdPromise==null)throw new U("POPUP_WINDOW_OPEN_FAILED","Couldn't open popup window to complete wallet action");if(typeof window<"u"){const V=C(pt=>y(pt.data),"listener");window.addEventListener("message",V),j.push(()=>window.removeEventListener("message",V))}}return new Promise((q,V)=>{const pt={uid:I,network:p,actionType:h,status:"initializing",inputs:A,popup:K,extension:D,walletOrigin:a,cleanupFns:j,resolve:q,reject:V};d=pt,E(pt),pt.interval=setInterval(()=>{if(d!=null){if(d.popup!=null&&d.popup.closed){b(new Dt("WINDOW_CLOSED","User closed the wallet window before completing the action",{details:{endTags:["INCOMPLETE_ACTION","WINDOW_CLOSED"]}}));return}E(d)}},ro)})},"connectAndWaitForResponse"),T=C(async(p,h,A)=>{var K;const I=o(p);for(const j of A)try{return await I.query({request_type:"view_access_key",finality:"optimistic",account_id:h,public_key:j}),j}catch{}const D=await I.query({request_type:"view_access_key_list",finality:"optimistic",account_id:h});if(!((K=D.keys)!=null&&K.length))throw new U("NO_ACCESS_KEYS",`No access keys found for account ${h}`);return D.keys[0].public_key},"findSignerPublicKey"),M=C(async(p,h,A,I)=>{const D=o(p),K=await D.block({finality:"final"}),j=await T(p,h,A),F=await D.query({request_type:"view_access_key",finality:"optimistic",account_id:h,public_key:j});return I.map((q,V)=>({signerId:h,publicKey:j,nonce:BigInt(F.nonce)+BigInt(V+1),receiverId:q.receiverId,blockHash:K.header.hash,actions:Ws(q.actions)}))},"prepareMeteorTransactions"),L=C(async p=>{var I,D;const h=await f(p);if(!h.accountId)return[];const A=((I=h.signedInContract)==null?void 0:I.public_key)??((D=h.allKeys)==null?void 0:D[0])??"";return[{accountId:h.accountId,publicKey:A}]},"getAccountsForNetwork"),w=C(async({network:p,contractId:h,methodNames:A})=>{const I=Rt(p),D=Kn(),K=Pn(D),j={type:A&&A.length>0?"SELECTED_METHODS":"ALL_METHODS",contract_id:h,methods:A??[],public_key:K},F=await _(I,"login",j).catch(V=>{throw kt(V)}),q=F.accountId??F.account_id;if(q==null)throw new U("INVALID_LOGIN_RESPONSE","Meteor login response did not contain an account id",{details:F});return await m(I,{accountId:q,allKeys:F.allKeys??[],signedInContract:h?{contract_id:h,public_key:K}:void 0}),L(I)},"signIn"),x=C(async({network:p})=>{const h=Rt(p),A=await f(h);A.accountId&&(A.signedInContract!=null&&await _(h,"logout",{accountId:A.accountId,contractInfo:A.signedInContract}).catch(I=>{throw kt(I)}),await v(h),await m(h,{allKeys:[]}))},"signOut"),B=C(async({network:p,message:h,accountId:A})=>{const I=Rt(p),D=await f(I),K=A??D.accountId;return _(I,"verify_owner",{accountId:K,message:h}).catch(j=>{throw kt(j)})},"verifyOwner"),N=C(async({network:p,message:h,nonce:A,recipient:I,callbackUrl:D,state:K,accountId:j})=>{var Wn;const F=Rt(p),q=await f(F),V=j??q.accountId;return{...await _(F,"sign_message",{message:h,nonce:A,recipient:I,callbackUrl:D??((Wn=t.getLocation)==null?void 0:Wn.call(t)),state:K,accountId:V}).catch(go=>{throw kt(go)}),state:K}},"signMessage"),P=C(async({network:p,signerId:h,transactions:A})=>{const I=Rt(p),D=await f(I),K=h??D.accountId;if(K==null)throw new U("NOT_SIGNED_IN","Wallet is not signed in");const F=(await M(I,K,D.allKeys??[],A)).map(co).join(","),q=await _(I,"sign",{transactions:F}).catch(V=>{throw kt(V)});return Array.isArray(q==null?void 0:q.executionOutcomes)?q.executionOutcomes:Array.isArray(q)?q:[q]},"signAndSendTransactions");return{signIn:w,signOut:x,getAccounts:C(({network:p})=>L(Rt(p)),"getAccounts"),verifyOwner:B,signMessage:N,signAndSendTransaction:C(async({network:p,signerId:h,receiverId:A,actions:I})=>(await P({network:p,signerId:h,transactions:[{receiverId:A,actions:I}]}))[0],"signAndSendTransaction"),signAndSendTransactions:P}},"createMeteorAdapter");var uo=Object.defineProperty,Hn=(t,e)=>uo(t,"name",{value:e,configurable:!0});const fo="session",Oe=class Oe{constructor(e,n=fo){l(this,"storage");l(this,"key");this.storage=e,this.key=n}defaultState(){return{mainnet:{activeAccount:null,accounts:{}},testnet:{activeAccount:null,accounts:{}}}}async get(){return _e(this.storage,this.key,this.defaultState())}async set(e){await Ee(this.storage,this.key,e)}async getKey(e,n){var o;const s=(o=(await this.get())[e])==null?void 0:o.accounts[n];if(s==null)throw new U("ACCOUNT_KEY_NOT_FOUND","Account key not found in session storage");return s}async setKey(e,n,r){const s=await this.get();s[e].accounts[n]=r,await this.set(s)}async removeKey(e,n){const r=await this.get();r[e].activeAccount===n&&(r[e].activeAccount=null),delete r[e].accounts[n],await this.set(r)}async getActiveAccount(e){return(await this.get())[e].activeAccount??null}async setActiveAccount(e,n){const r=await this.get();if(!Object.prototype.hasOwnProperty.call(r[e].accounts,n))throw new U("INVALID_ACCOUNT_ID","Cannot set active account that does not exist in session storage");r[e].activeAccount=n,await this.set(r)}async getAccounts(e){const n=await this.get();return Object.keys(n[e].accounts)}};Hn(Oe,"SessionRepository");let Fn=Oe;const Te=class Te{constructor(e,n){l(this,"backendUrl");l(this,"fetcher");this.backendUrl=e.replace(/\/$/,""),this.fetcher=n??fetch}async request(e,n={},r=3e4){const s=new AbortController,o=setTimeout(()=>s.abort(),r);try{const a=await this.fetcher(`${this.backendUrl}${e}`,{...n,headers:{"Content-Type":"application/json",...n.headers??{}},signal:s.signal});if(!a.ok){const i=await a.text().catch(()=>"Unknown API error");throw new U("API_HTTP_ERROR",`Near Mobile backend request failed (${a.status}): ${i}`)}return a.status===204?void 0:await a.json()}catch(a){throw s.signal.aborted?new U("API_TIMEOUT","Near Mobile backend request timed out",{cause:a}):a instanceof U?a:new U("API_NETWORK_ERROR","Near Mobile backend request failed",{cause:a})}finally{clearTimeout(o)}}async createRequest(e,n,r){return this.request("/api/signer-request",{method:"POST",body:JSON.stringify({network:e,transactions:n,dAppMetadata:r})})}async getRequestStatus(e){return this.request(`/api/signer-request/${e}/status`,{method:"GET"})}async getRequest(e){return this.request(`/api/signer-request/${e}`,{method:"GET"})}async rejectRequest(e){await this.request(`/api/signer-request/${e}/reject`,{method:"POST"})}async createSignMessageRequest(e,n,r,s,o,a){return this.request("/api/signer-request/message",{method:"POST",body:JSON.stringify({network:e,message:n,receiver:r,nonce:s,callbackUrl:o,receiverMetadata:a})})}async getSignMessageRequest(e){return this.request(`/api/signer-request/message/${e}`,{method:"GET"})}async rejectSignMessageRequest(e){await this.request(`/api/signer-request/message/${e}/reject`,{method:"POST"})}};Hn(Te,"NearMobileApiClient");let zn=Te;const lo={mainnet:"https://relmn.aurora.dev",testnet:"https://rpc.testnet.near.org"},gt=ao({appKeyPrefix:"near_app",getLocation:()=>window.selector.location,getNetworkProviders:t=>{var n,r;const e=(r=(n=window.selector)==null?void 0:n.providers)==null?void 0:r[t];return e&&e.length>0?e:[lo[t]]},storage:{get:t=>window.selector.storage.get(t),set:(t,e)=>window.selector.storage.set(t,e),remove:t=>window.selector.storage.remove(t)},openWindow:(t,e,n)=>window.selector.open(t,e,n),getExtensionBridge:()=>{const t=window;return t.meteorComV2??t.meteorCom}}),ho=t=>t instanceof U&&t.code==="POPUP_WINDOW_OPEN_FAILED"?!0:(t instanceof Error?t.message:String(t)).includes("popup"),Ct=async t=>{const{title:e,button:n,execute:r}=t;try{return await r()}catch(s){if(!ho(s))throw s;return await window.selector.ui.whenApprove({title:e,button:n}),r()}};(async()=>({async signIn({network:t,contractId:e,methodNames:n}){return Ct({title:"Sign in",button:"Open wallet",execute:()=>gt.signIn({network:t,contractId:e,methodNames:n})})},async signOut({network:t}){await Ct({title:"Sign out",button:"Open wallet",execute:()=>gt.signOut({network:t})})},async isSignedIn({network:t}){return(await gt.getAccounts({network:t})).length>0},async getAccounts({network:t}){return gt.getAccounts({network:t})},async verifyOwner({network:t,message:e,accountId:n}){return Ct({title:"Verify owner",button:"Open wallet",execute:()=>gt.verifyOwner({network:t,message:e,accountId:n})})},async signMessage({network:t,message:e,nonce:n,recipient:r,callbackUrl:s,state:o,accountId:a}){return Ct({title:"Sign message",button:"Open wallet",execute:()=>gt.signMessage({network:t,message:e,nonce:n,recipient:r,callbackUrl:s,state:o,accountId:a})})},async signInAndSignMessage({network:t,contractId:e,methodNames:n,message:r,nonce:s,recipient:o,callbackUrl:a,state:i}){var d;const u=(d=(await this.signIn({network:t,contractId:e,methodNames:n}))[0])==null?void 0:d.accountId;return this.signMessage({network:t,message:r,nonce:s,recipient:o,callbackUrl:a,state:i,accountId:u})},async signAndSendTransaction({network:t,signerId:e,receiverId:n,actions:r}){return Ct({title:"Sign transaction",button:"Open wallet",execute:()=>gt.signAndSendTransaction({network:t,signerId:e,receiverId:n,actions:r})})},async signAndSendTransactions({network:t,signerId:e,transactions:n}){return Ct({title:"Sign transactions",button:"Open wallet",execute:()=>gt.signAndSendTransactions({network:t,signerId:e,transactions:n})})}}))().then(t=>{window.selector.ready(t)})})();
