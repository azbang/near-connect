var Go=Object.defineProperty;var Xo=(ae,J,H)=>J in ae?Go(ae,J,{enumerable:!0,configurable:!0,writable:!0,value:H}):ae[J]=H;var g=(ae,J,H)=>Xo(ae,typeof J!="symbol"?J+"":J,H);(function(){"use strict";/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */var Oe;function ae(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function J(e,t=""){if(!Number.isSafeInteger(e)||e<0){const n=t&&`"${t}" `;throw new Error(`${n}expected integer >= 0, got ${e}`)}}function H(e,t,n=""){const r=ae(e),o=e==null?void 0:e.length,s=t!==void 0;if(!r||s&&o!==t){const a=n&&`"${n}" `,c=s?` of length ${t}`:"",i=r?`length=${o}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+c+", got "+i)}return e}function vt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function qn(e,t){H(e,void 0,"digestInto() output");const n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function De(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function et(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Q(e,t){return e<<32-t|e>>>t}const Et=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",jn=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function tt(e){if(H(e),Et)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=jn[e[n]];return t}const se={_0:48,_9:57,A:65,F:70,a:97,f:102};function At(e){if(e>=se._0&&e<=se._9)return e-se._0;if(e>=se.A&&e<=se.F)return e-(se.A-10);if(e>=se.a&&e<=se.f)return e-(se.a-10)}function _t(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Et)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){const a=At(e.charCodeAt(s)),c=At(e.charCodeAt(s+1));if(a===void 0||c===void 0){const i=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+i+'" at index '+s)}r[o]=a*16+c}return r}function Bt(...e){let t=0;for(let r=0;r<e.length;r++){const o=e[r];H(o),t+=o.length}const n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){const s=e[r];n.set(s,o),o+=s.length}return n}function St(e,t={}){const n=(o,s)=>e(s).update(o).digest(),r=e(void 0);return n.outputLen=r.outputLen,n.blockLen=r.blockLen,n.create=o=>e(o),Object.assign(n,t),Object.freeze(n)}function Hn(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof(t==null?void 0:t.getRandomValues)!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}const It=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function Ln(e,t,n){return e&t^~e&n}function Mn(e,t,n){return e&t^e&n^t&n}class Tt{constructor(t,n,r,o){g(this,"blockLen");g(this,"outputLen");g(this,"padOffset");g(this,"isLE");g(this,"buffer");g(this,"view");g(this,"finished",!1);g(this,"length",0);g(this,"pos",0);g(this,"destroyed",!1);this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=et(this.buffer)}update(t){vt(this),H(t);const{view:n,buffer:r,blockLen:o}=this,s=t.length;for(let a=0;a<s;){const c=Math.min(o-this.pos,s-a);if(c===o){const i=et(t);for(;o<=s-a;a+=o)this.process(i,a);continue}r.set(t.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){vt(this),qn(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:s}=this;let{pos:a}=this;n[a++]=128,De(this.buffer.subarray(a)),this.padOffset>o-a&&(this.process(r,0),a=0);for(let l=a;l<o;l++)n[l]=0;r.setBigUint64(o-8,BigInt(this.length*8),s),this.process(r,0);const c=et(t),i=this.outputLen;if(i%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const f=i/4,x=this.get();if(f>x.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)c.setUint32(4*l,x[l],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:s,destroyed:a,pos:c}=this;return t.destroyed=a,t.finished=s,t.length=o,t.pos=c,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const fe=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),F=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),He=BigInt(2**32-1),Rt=BigInt(32);function Zn(e,t=!1){return t?{h:Number(e&He),l:Number(e>>Rt&He)}:{h:Number(e>>Rt&He)|0,l:Number(e&He)|0}}function $n(e,t=!1){const n=e.length;let r=new Uint32Array(n),o=new Uint32Array(n);for(let s=0;s<n;s++){const{h:a,l:c}=Zn(e[s],t);[r[s],o[s]]=[a,c]}return[r,o]}const Ct=(e,t,n)=>e>>>n,Ot=(e,t,n)=>e<<32-n|t>>>n,Ae=(e,t,n)=>e>>>n|t<<32-n,_e=(e,t,n)=>e<<32-n|t>>>n,Le=(e,t,n)=>e<<64-n|t>>>n-32,Me=(e,t,n)=>e>>>n-32|t<<64-n;function ie(e,t,n,r){const o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}const Fn=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),zn=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Vn=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Yn=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,Gn=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),Xn=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0,Jn=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ue=new Uint32Array(64);class Wn extends Tt{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:n,C:r,D:o,E:s,F:a,G:c,H:i}=this;return[t,n,r,o,s,a,c,i]}set(t,n,r,o,s,a,c,i){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=a|0,this.G=c|0,this.H=i|0}process(t,n){for(let l=0;l<16;l++,n+=4)ue[l]=t.getUint32(n,!1);for(let l=16;l<64;l++){const E=ue[l-15],C=ue[l-2],O=Q(E,7)^Q(E,18)^E>>>3,T=Q(C,17)^Q(C,19)^C>>>10;ue[l]=T+ue[l-7]+O+ue[l-16]|0}let{A:r,B:o,C:s,D:a,E:c,F:i,G:f,H:x}=this;for(let l=0;l<64;l++){const E=Q(c,6)^Q(c,11)^Q(c,25),C=x+E+Ln(c,i,f)+Jn[l]+ue[l]|0,T=(Q(r,2)^Q(r,13)^Q(r,22))+Mn(r,o,s)|0;x=f,f=i,i=c,c=a+C|0,a=s,s=o,o=r,r=C+T|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,a=a+this.D|0,c=c+this.E|0,i=i+this.F|0,f=f+this.G|0,x=x+this.H|0,this.set(r,o,s,a,c,i,f,x)}roundClean(){De(ue)}destroy(){this.set(0,0,0,0,0,0,0,0),De(this.buffer)}}class Qn extends Wn{constructor(){super(32);g(this,"A",fe[0]|0);g(this,"B",fe[1]|0);g(this,"C",fe[2]|0);g(this,"D",fe[3]|0);g(this,"E",fe[4]|0);g(this,"F",fe[5]|0);g(this,"G",fe[6]|0);g(this,"H",fe[7]|0)}}const Dt=$n(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),er=Dt[0],tr=Dt[1],le=new Uint32Array(80),he=new Uint32Array(80);class nr extends Tt{constructor(t){super(128,t,16,!1)}get(){const{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:a,Dh:c,Dl:i,Eh:f,El:x,Fh:l,Fl:E,Gh:C,Gl:O,Hh:T,Hl:A}=this;return[t,n,r,o,s,a,c,i,f,x,l,E,C,O,T,A]}set(t,n,r,o,s,a,c,i,f,x,l,E,C,O,T,A){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=a|0,this.Dh=c|0,this.Dl=i|0,this.Eh=f|0,this.El=x|0,this.Fh=l|0,this.Fl=E|0,this.Gh=C|0,this.Gl=O|0,this.Hh=T|0,this.Hl=A|0}process(t,n){for(let y=0;y<16;y++,n+=4)le[y]=t.getUint32(n),he[y]=t.getUint32(n+=4);for(let y=16;y<80;y++){const B=le[y-15]|0,N=he[y-15]|0,j=Ae(B,N,1)^Ae(B,N,8)^Ct(B,N,7),P=_e(B,N,1)^_e(B,N,8)^Ot(B,N,7),b=le[y-2]|0,w=he[y-2]|0,S=Ae(b,w,19)^Le(b,w,61)^Ct(b,w,6),k=_e(b,w,19)^Me(b,w,61)^Ot(b,w,6),h=Vn(P,k,he[y-7],he[y-16]),u=Yn(h,j,S,le[y-7],le[y-16]);le[y]=u|0,he[y]=h|0}let{Ah:r,Al:o,Bh:s,Bl:a,Ch:c,Cl:i,Dh:f,Dl:x,Eh:l,El:E,Fh:C,Fl:O,Gh:T,Gl:A,Hh:D,Hl:m}=this;for(let y=0;y<80;y++){const B=Ae(l,E,14)^Ae(l,E,18)^Le(l,E,41),N=_e(l,E,14)^_e(l,E,18)^Me(l,E,41),j=l&C^~l&T,P=E&O^~E&A,b=Gn(m,N,P,tr[y],he[y]),w=Xn(b,D,B,j,er[y],le[y]),S=b|0,k=Ae(r,o,28)^Le(r,o,34)^Le(r,o,39),h=_e(r,o,28)^Me(r,o,34)^Me(r,o,39),u=r&s^r&c^s&c,p=o&a^o&i^a&i;D=T|0,m=A|0,T=C|0,A=O|0,C=l|0,O=E|0,{h:l,l:E}=ie(f|0,x|0,w|0,S|0),f=c|0,x=i|0,c=s|0,i=a|0,s=r|0,a=o|0;const d=Fn(S,h,p);r=zn(d,w,k,u),o=d|0}({h:r,l:o}=ie(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:a}=ie(this.Bh|0,this.Bl|0,s|0,a|0),{h:c,l:i}=ie(this.Ch|0,this.Cl|0,c|0,i|0),{h:f,l:x}=ie(this.Dh|0,this.Dl|0,f|0,x|0),{h:l,l:E}=ie(this.Eh|0,this.El|0,l|0,E|0),{h:C,l:O}=ie(this.Fh|0,this.Fl|0,C|0,O|0),{h:T,l:A}=ie(this.Gh|0,this.Gl|0,T|0,A|0),{h:D,l:m}=ie(this.Hh|0,this.Hl|0,D|0,m|0),this.set(r,o,s,a,c,i,f,x,l,E,C,O,T,A,D,m)}roundClean(){De(le,he)}destroy(){De(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class rr extends nr{constructor(){super(64);g(this,"Ah",F[0]|0);g(this,"Al",F[1]|0);g(this,"Bh",F[2]|0);g(this,"Bl",F[3]|0);g(this,"Ch",F[4]|0);g(this,"Cl",F[5]|0);g(this,"Dh",F[6]|0);g(this,"Dl",F[7]|0);g(this,"Eh",F[8]|0);g(this,"El",F[9]|0);g(this,"Fh",F[10]|0);g(this,"Fl",F[11]|0);g(this,"Gh",F[12]|0);g(this,"Gl",F[13]|0);g(this,"Hh",F[14]|0);g(this,"Hl",F[15]|0)}}const or=St(()=>new Qn,It(1)),sr=St(()=>new rr,It(3));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Nt=BigInt(0),kt=BigInt(1);function nt(e,t=""){if(typeof e!="boolean"){const n=t&&`"${t}" `;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function ir(e){if(typeof e=="bigint"){if(!$e(e))throw new Error("positive bigint expected, got "+e)}else J(e);return e}function Kt(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Nt:BigInt("0x"+e)}function cr(e){return Kt(tt(e))}function Ze(e){return Kt(tt(rt(H(e)).reverse()))}function Ut(e,t){J(t),e=ir(e);const n=_t(e.toString(16).padStart(t*2,"0"));if(n.length!==t)throw new Error("number too large");return n}function ar(e,t){return Ut(e,t).reverse()}function rt(e){return Uint8Array.from(e)}const $e=e=>typeof e=="bigint"&&Nt<=e;function fr(e,t,n){return $e(e)&&$e(t)&&$e(n)&&t<=e&&e<n}function Pt(e,t,n,r){if(!fr(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}const ur=e=>(kt<<BigInt(e))-kt;function ot(e,t={},n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(s,a,c){const i=e[s];if(c&&i===void 0)return;const f=typeof i;if(f!==a||i===null)throw new Error(`param "${s}" is invalid: expected ${a}, got ${f}`)}const o=(s,a)=>Object.entries(s).forEach(([c,i])=>r(c,i,a));o(t,!1),o(n,!0)}function qt(e){const t=new WeakMap;return(n,...r)=>{const o=t.get(n);if(o!==void 0)return o;const s=e(n,...r);return t.set(n,s),s}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const V=BigInt(0),z=BigInt(1),ye=BigInt(2),jt=BigInt(3),Ht=BigInt(4),Lt=BigInt(5),lr=BigInt(7),Mt=BigInt(8),hr=BigInt(9),Zt=BigInt(16);function L(e,t){const n=e%t;return n>=V?n:t+n}function ee(e,t,n){let r=e;for(;t-- >V;)r*=r,r%=n;return r}function $t(e,t){if(e===V)throw new Error("invert: expected non-zero number");if(t<=V)throw new Error("invert: expected positive modulus, got "+t);let n=L(e,t),r=t,o=V,s=z;for(;n!==V;){const c=r/n,i=r%n,f=o-s*c;r=n,n=i,o=s,s=f}if(r!==z)throw new Error("invert: does not exist");return L(o,t)}function st(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function Ft(e,t){const n=(e.ORDER+z)/Ht,r=e.pow(t,n);return st(e,r,t),r}function dr(e,t){const n=(e.ORDER-Lt)/Mt,r=e.mul(t,ye),o=e.pow(r,n),s=e.mul(t,o),a=e.mul(e.mul(s,ye),o),c=e.mul(s,e.sub(a,e.ONE));return st(e,c,t),c}function pr(e){const t=it(e),n=zt(e),r=n(t,t.neg(t.ONE)),o=n(t,r),s=n(t,t.neg(r)),a=(e+lr)/Zt;return(c,i)=>{let f=c.pow(i,a),x=c.mul(f,r);const l=c.mul(f,o),E=c.mul(f,s),C=c.eql(c.sqr(x),i),O=c.eql(c.sqr(l),i);f=c.cmov(f,x,C),x=c.cmov(E,l,O);const T=c.eql(c.sqr(x),i),A=c.cmov(f,x,T);return st(c,A,i),A}}function zt(e){if(e<jt)throw new Error("sqrt is not defined for small field");let t=e-z,n=0;for(;t%ye===V;)t/=ye,n++;let r=ye;const o=it(e);for(;Yt(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return Ft;let s=o.pow(r,t);const a=(t+z)/ye;return function(i,f){if(i.is0(f))return f;if(Yt(i,f)!==1)throw new Error("Cannot find square root");let x=n,l=i.mul(i.ONE,s),E=i.pow(f,t),C=i.pow(f,a);for(;!i.eql(E,i.ONE);){if(i.is0(E))return i.ZERO;let O=1,T=i.sqr(E);for(;!i.eql(T,i.ONE);)if(O++,T=i.sqr(T),O===x)throw new Error("Cannot find square root");const A=z<<BigInt(x-O-1),D=i.pow(l,A);x=O,l=i.sqr(D),E=i.mul(E,l),C=i.mul(C,D)}return C}}function gr(e){return e%Ht===jt?Ft:e%Mt===Lt?dr:e%Zt===hr?pr(e):zt(e)}const yr=(e,t)=>(L(e,t)&z)===z,wr=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function br(e){const t={ORDER:"bigint",BYTES:"number",BITS:"number"},n=wr.reduce((r,o)=>(r[o]="function",r),t);return ot(e,n),e}function xr(e,t,n){if(n<V)throw new Error("invalid exponent, negatives unsupported");if(n===V)return e.ONE;if(n===z)return t;let r=e.ONE,o=t;for(;n>V;)n&z&&(r=e.mul(r,o)),o=e.sqr(o),n>>=z;return r}function Vt(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((a,c,i)=>e.is0(c)?a:(r[i]=a,e.mul(a,c)),e.ONE),s=e.inv(o);return t.reduceRight((a,c,i)=>e.is0(c)?a:(r[i]=e.mul(a,r[i]),e.mul(a,c)),s),r}function Yt(e,t){const n=(e.ORDER-z)/ye,r=e.pow(t,n),o=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),a=e.eql(r,e.neg(e.ONE));if(!o&&!s&&!a)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function mr(e,t){t!==void 0&&J(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}class vr{constructor(t,n={}){g(this,"ORDER");g(this,"BITS");g(this,"BYTES");g(this,"isLE");g(this,"ZERO",V);g(this,"ONE",z);g(this,"_lengths");g(this,"_sqrt");g(this,"_mod");var a;if(t<=V)throw new Error("invalid field: expected ORDER > 0, got "+t);let r;this.isLE=!1,n!=null&&typeof n=="object"&&(typeof n.BITS=="number"&&(r=n.BITS),typeof n.sqrt=="function"&&(this.sqrt=n.sqrt),typeof n.isLE=="boolean"&&(this.isLE=n.isLE),n.allowedLengths&&(this._lengths=(a=n.allowedLengths)==null?void 0:a.slice()),typeof n.modFromBytes=="boolean"&&(this._mod=n.modFromBytes));const{nBitLength:o,nByteLength:s}=mr(t,r);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=o,this.BYTES=s,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return L(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return V<=t&&t<this.ORDER}is0(t){return t===V}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&z)===z}neg(t){return L(-t,this.ORDER)}eql(t,n){return t===n}sqr(t){return L(t*t,this.ORDER)}add(t,n){return L(t+n,this.ORDER)}sub(t,n){return L(t-n,this.ORDER)}mul(t,n){return L(t*n,this.ORDER)}pow(t,n){return xr(this,t,n)}div(t,n){return L(t*$t(n,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,n){return t+n}subN(t,n){return t-n}mulN(t,n){return t*n}inv(t){return $t(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=gr(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?ar(t,this.BYTES):Ut(t,this.BYTES)}fromBytes(t,n=!1){H(t);const{_lengths:r,BYTES:o,isLE:s,ORDER:a,_mod:c}=this;if(r){if(!r.includes(t.length)||t.length>o)throw new Error("Field.fromBytes: expected "+r+" bytes, got "+t.length);const f=new Uint8Array(o);f.set(t,s?0:f.length-t.length),t=f}if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);let i=s?Ze(t):cr(t);if(c&&(i=L(i,a)),!n&&!this.isValid(i))throw new Error("invalid field element: outside of range 0..ORDER");return i}invertBatch(t){return Vt(this,t)}cmov(t,n,r){return r?n:t}}function it(e,t={}){return new vr(e,t)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Fe=BigInt(0),ct=BigInt(1);function Gt(e,t){const n=t.negate();return e?n:t}function at(e,t){const n=Vt(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}function Xt(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function ft(e,t){Xt(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,s=ur(e),a=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:o,shiftBy:a}}function Jt(e,t,n){const{windowSize:r,mask:o,maxNumber:s,shiftBy:a}=n;let c=Number(e&o),i=e>>a;c>r&&(c-=s,i+=ct);const f=t*r,x=f+Math.abs(c)-1,l=c===0,E=c<0,C=t%2!==0;return{nextN:i,offset:x,isZero:l,isNeg:E,isNegF:C,offsetF:f}}const ut=new WeakMap,Wt=new WeakMap;function lt(e){return Wt.get(e)||1}function Qt(e){if(e!==Fe)throw new Error("invalid wNAF")}class Er{constructor(t,n){g(this,"BASE");g(this,"ZERO");g(this,"Fn");g(this,"bits");this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>Fe;)n&ct&&(r=r.add(o)),o=o.double(),n>>=ct;return r}precomputeWindow(t,n){const{windows:r,windowSize:o}=ft(n,this.bits),s=[];let a=t,c=a;for(let i=0;i<r;i++){c=a,s.push(c);for(let f=1;f<o;f++)c=c.add(a),s.push(c);a=c.double()}return s}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,s=this.BASE;const a=ft(t,this.bits);for(let c=0;c<a.windows;c++){const{nextN:i,offset:f,isZero:x,isNeg:l,isNegF:E,offsetF:C}=Jt(r,c,a);r=i,x?s=s.add(Gt(E,n[C])):o=o.add(Gt(l,n[f]))}return Qt(r),{p:o,f:s}}wNAFUnsafe(t,n,r,o=this.ZERO){const s=ft(t,this.bits);for(let a=0;a<s.windows&&r!==Fe;a++){const{nextN:c,offset:i,isZero:f,isNeg:x}=Jt(r,a,s);if(r=c,!f){const l=n[i];o=o.add(x?l.negate():l)}}return Qt(r),o}getPrecomputes(t,n,r){let o=ut.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),ut.set(n,o))),o}cached(t,n,r){const o=lt(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){const s=lt(t);return s===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(s,this.getPrecomputes(s,t,r),n,o)}createCache(t,n){Xt(n,this.bits),Wt.set(t,n),ut.delete(t)}hasCache(t){return lt(t)!==1}}function en(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return br(t),t}else return it(e,{isLE:n})}function Ar(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const i of["p","n","h"]){const f=t[i];if(!(typeof f=="bigint"&&f>Fe))throw new Error(`CURVE.${i} must be positive bigint`)}const o=en(t.p,n.Fp,r),s=en(t.n,n.Fn,r),c=["Gx","Gy","a","d"];for(const i of c)if(!o.isValid(t[i]))throw new Error(`CURVE.${i} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:s}}function _r(e,t){return function(r){const o=e(r);return{secretKey:o,publicKey:t(o)}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const de=BigInt(0),M=BigInt(1),ht=BigInt(2),Br=BigInt(8);function Sr(e,t,n,r){const o=e.sqr(n),s=e.sqr(r),a=e.add(e.mul(t.a,o),s),c=e.add(e.ONE,e.mul(t.d,e.mul(o,s)));return e.eql(a,c)}function Ir(e,t={}){const n=Ar("edwards",e,t,t.FpFnLE),{Fp:r,Fn:o}=n;let s=n.CURVE;const{h:a}=s;ot(t,{},{uvRatio:"function"});const c=ht<<BigInt(o.BYTES*8)-M,i=D=>r.create(D),f=t.uvRatio||((D,m)=>{try{return{isValid:!0,value:r.sqrt(r.div(D,m))}}catch{return{isValid:!1,value:de}}});if(!Sr(r,s,s.Gx,s.Gy))throw new Error("bad curve params: generator point");function x(D,m,y=!1){const B=y?M:de;return Pt("coordinate "+D,m,B,c),m}function l(D){if(!(D instanceof O))throw new Error("EdwardsPoint expected")}const E=qt((D,m)=>{const{X:y,Y:B,Z:N}=D,j=D.is0();m==null&&(m=j?Br:r.inv(N));const P=i(y*m),b=i(B*m),w=r.mul(N,m);if(j)return{x:de,y:M};if(w!==M)throw new Error("invZ was invalid");return{x:P,y:b}}),C=qt(D=>{const{a:m,d:y}=s;if(D.is0())throw new Error("bad point: ZERO");const{X:B,Y:N,Z:j,T:P}=D,b=i(B*B),w=i(N*N),S=i(j*j),k=i(S*S),h=i(b*m),u=i(S*i(h+w)),p=i(k+i(y*i(b*w)));if(u!==p)throw new Error("bad point: equation left != right (1)");const d=i(B*N),v=i(j*P);if(d!==v)throw new Error("bad point: equation left != right (2)");return!0}),A=class A{constructor(m,y,B,N){g(this,"X");g(this,"Y");g(this,"Z");g(this,"T");this.X=x("x",m),this.Y=x("y",y),this.Z=x("z",B,!0),this.T=x("t",N),Object.freeze(this)}static CURVE(){return s}static fromAffine(m){if(m instanceof A)throw new Error("extended point not allowed");const{x:y,y:B}=m||{};return x("x",y),x("y",B),new A(y,B,M,i(y*B))}static fromBytes(m,y=!1){const B=r.BYTES,{a:N,d:j}=s;m=rt(H(m,B,"point")),nt(y,"zip215");const P=rt(m),b=m[B-1];P[B-1]=b&-129;const w=Ze(P),S=y?c:r.ORDER;Pt("point.y",w,de,S);const k=i(w*w),h=i(k-M),u=i(j*k-N);let{isValid:p,value:d}=f(h,u);if(!p)throw new Error("bad point: invalid y coordinate");const v=(d&M)===M,_=(b&128)!==0;if(!y&&d===de&&_)throw new Error("bad point: x=0 and x_0=1");return _!==v&&(d=i(-d)),A.fromAffine({x:d,y:w})}static fromHex(m,y=!1){return A.fromBytes(_t(m),y)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(m=8,y=!0){return T.createCache(this,m),y||this.multiply(ht),this}assertValidity(){C(this)}equals(m){l(m);const{X:y,Y:B,Z:N}=this,{X:j,Y:P,Z:b}=m,w=i(y*b),S=i(j*N),k=i(B*b),h=i(P*N);return w===S&&k===h}is0(){return this.equals(A.ZERO)}negate(){return new A(i(-this.X),this.Y,this.Z,i(-this.T))}double(){const{a:m}=s,{X:y,Y:B,Z:N}=this,j=i(y*y),P=i(B*B),b=i(ht*i(N*N)),w=i(m*j),S=y+B,k=i(i(S*S)-j-P),h=w+P,u=h-b,p=w-P,d=i(k*u),v=i(h*p),_=i(k*p),I=i(u*h);return new A(d,v,I,_)}add(m){l(m);const{a:y,d:B}=s,{X:N,Y:j,Z:P,T:b}=this,{X:w,Y:S,Z:k,T:h}=m,u=i(N*w),p=i(j*S),d=i(b*B*h),v=i(P*k),_=i((N+j)*(w+S)-u-p),I=v-d,R=v+d,U=i(p-y*u),q=i(_*I),W=i(R*U),oe=i(_*U),ve=i(I*R);return new A(q,W,ve,oe)}subtract(m){return this.add(m.negate())}multiply(m){if(!o.isValidNot0(m))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:y,f:B}=T.cached(this,m,N=>at(A,N));return at(A,[y,B])[0]}multiplyUnsafe(m,y=A.ZERO){if(!o.isValid(m))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return m===de?A.ZERO:this.is0()||m===M?this:T.unsafe(this,m,B=>at(A,B),y)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return T.unsafe(this,s.n).is0()}toAffine(m){return E(this,m)}clearCofactor(){return a===M?this:this.multiplyUnsafe(a)}toBytes(){const{x:m,y}=this.toAffine(),B=r.toBytes(y);return B[B.length-1]|=m&M?128:0,B}toHex(){return tt(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}};g(A,"BASE",new A(s.Gx,s.Gy,M,i(s.Gx*s.Gy))),g(A,"ZERO",new A(de,M,M,de)),g(A,"Fp",r),g(A,"Fn",o);let O=A;const T=new Er(O,o.BITS);return O.BASE.precompute(8),O}function Tr(e,t,n={}){if(typeof t!="function")throw new Error('"hash" function param is required');ot(n,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r}=n,{BASE:o,Fp:s,Fn:a}=e,c=n.randomBytes||Hn,i=n.adjustScalarBytes||(b=>b),f=n.domain||((b,w,S)=>{if(nt(S,"phflag"),w.length||S)throw new Error("Contexts/pre-hash are not supported");return b});function x(b){return a.create(Ze(b))}function l(b){const w=y.secretKey;H(b,y.secretKey,"secretKey");const S=H(t(b),2*w,"hashedSecretKey"),k=i(S.slice(0,w)),h=S.slice(w,2*w),u=x(k);return{head:k,prefix:h,scalar:u}}function E(b){const{head:w,prefix:S,scalar:k}=l(b),h=o.multiply(k),u=h.toBytes();return{head:w,prefix:S,scalar:k,point:h,pointBytes:u}}function C(b){return E(b).pointBytes}function O(b=Uint8Array.of(),...w){const S=Bt(...w);return x(t(f(S,H(b,void 0,"context"),!!r)))}function T(b,w,S={}){b=H(b,void 0,"message"),r&&(b=r(b));const{prefix:k,scalar:h,pointBytes:u}=E(w),p=O(S.context,k,b),d=o.multiply(p).toBytes(),v=O(S.context,d,u,b),_=a.create(p+v*h);if(!a.isValid(_))throw new Error("sign failed: invalid s");const I=Bt(d,a.toBytes(_));return H(I,y.signature,"result")}const A={zip215:!0};function D(b,w,S,k=A){const{context:h,zip215:u}=k,p=y.signature;b=H(b,p,"signature"),w=H(w,void 0,"message"),S=H(S,y.publicKey,"publicKey"),u!==void 0&&nt(u,"zip215"),r&&(w=r(w));const d=p/2,v=b.subarray(0,d),_=Ze(b.subarray(d,p));let I,R,U;try{I=e.fromBytes(S,u),R=e.fromBytes(v,u),U=o.multiplyUnsafe(_)}catch{return!1}if(!u&&I.isSmallOrder())return!1;const q=O(h,R.toBytes(),I.toBytes(),w);return R.add(I.multiplyUnsafe(q)).subtract(U).clearCofactor().is0()}const m=s.BYTES,y={secretKey:m,publicKey:m,signature:2*m,seed:m};function B(b=c(y.seed)){return H(b,y.seed,"seed")}function N(b){return ae(b)&&b.length===a.BYTES}function j(b,w){try{return!!e.fromBytes(b,w)}catch{return!1}}const P={getExtendedPublicKey:E,randomSecretKey:B,isValidSecretKey:N,isValidPublicKey:j,toMontgomery(b){const{y:w}=e.fromBytes(b),S=y.publicKey,k=S===32;if(!k&&S!==57)throw new Error("only defined for 25519 and 448");const h=k?s.div(M+w,M-w):s.div(w-M,w+M);return s.toBytes(h)},toMontgomerySecret(b){const w=y.secretKey;H(b,w);const S=t(b.subarray(0,w));return i(S).subarray(0,w)}};return Object.freeze({keygen:_r(B,C),getPublicKey:C,sign:T,verify:D,utils:P,Point:e,lengths:y})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Rr=BigInt(1),tn=BigInt(2),Cr=BigInt(5),Or=BigInt(8),dt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Dr={p:dt,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Or,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Nr(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),s=dt,c=e*e%s*e%s,i=ee(c,tn,s)*c%s,f=ee(i,Rr,s)*e%s,x=ee(f,Cr,s)*f%s,l=ee(x,t,s)*x%s,E=ee(l,n,s)*l%s,C=ee(E,r,s)*E%s,O=ee(C,o,s)*C%s,T=ee(O,o,s)*C%s,A=ee(T,t,s)*x%s;return{pow_p_5_8:ee(A,tn,s)*e%s,b2:c}}function kr(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const nn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Kr(e,t){const n=dt,r=L(t*t*t,n),o=L(r*r*t,n),s=Nr(e*o).pow_p_5_8;let a=L(e*r*s,n);const c=L(t*a*a,n),i=a,f=L(a*nn,n),x=c===e,l=c===L(-e,n),E=c===L(-e*nn,n);return x&&(a=i),(l||E)&&(a=f),yr(a,n)&&(a=L(-a,n)),{isValid:x||l,value:a}}const Ur=Ir(Dr,{uvRatio:Kr});function Pr(e){return Tr(Ur,sr,Object.assign({adjustScalarBytes:kr},e))}const rn=Pr({}),Ne="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";function ke(e){if(!e||typeof e!="string")throw new Error(`Expected base58 string but got “${e}”`);if(e.match(/[IOl0]/gmu))throw new Error(`Invalid base58 character “${e.match(/[IOl0]/gmu)}”`);const t=e.match(/^1+/gmu),n=t?t[0].length:0,r=(e.length-n)*(Math.log(58)/Math.log(256))+1>>>0;return new Uint8Array([...new Uint8Array(n),...e.match(/.{1}/gmu).map(o=>Ne.indexOf(o)).reduce((o,s)=>(o=o.map(a=>{const c=a*58+s;return s=c>>8,c}),o),new Uint8Array(r)).reverse().filter((o=>s=>o=o||s)(!1))])}const qr=(()=>{const e=Array(256).fill(-1);for(let t=0;t<Ne.length;++t)e[Ne.charCodeAt(t)]=t;return e})();function ze(e){const t=[];for(const n of e){let r=n;for(let o=0;o<t.length;++o){const s=(qr[t[o]]<<8)+r;t[o]=Ne.charCodeAt(s%58),r=s/58|0}for(;r;)t.push(Ne.charCodeAt(r%58)),r=r/58|0}for(const n of e){if(n)break;t.push(49)}return t.reverse(),String.fromCharCode(...t)}var jr=20,Hr=1,we=1e6,on=1e6,Lr=-7,Mr=21,Zr=!1,Ke="[big.js] ",be=Ke+"Invalid ",Ve=be+"decimal places",$r=be+"rounding mode",sn=Ke+"Division by zero",K={},te=void 0,Fr=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function cn(){function e(t){var n=this;if(!(n instanceof e))return t===te&&arguments.length===0?cn():new e(t);if(t instanceof e)n.s=t.s,n.e=t.e,n.c=t.c.slice();else{if(typeof t!="string"){if(e.strict===!0&&typeof t!="bigint")throw TypeError(be+"value");t=t===0&&1/t<0?"-0":String(t)}zr(n,t)}n.constructor=e}return e.prototype=K,e.DP=jr,e.RM=Hr,e.NE=Lr,e.PE=Mr,e.strict=Zr,e.roundDown=0,e.roundHalfUp=1,e.roundHalfEven=2,e.roundUp=3,e}function zr(e,t){var n,r,o;if(!Fr.test(t))throw Error(be+"number");for(e.s=t.charAt(0)=="-"?(t=t.slice(1),-1):1,(n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),o=t.length,r=0;r<o&&t.charAt(r)=="0";)++r;if(r==o)e.c=[e.e=0];else{for(;o>0&&t.charAt(--o)=="0";);for(e.e=n-r-1,e.c=[],n=0;r<=o;)e.c[n++]=+t.charAt(r++)}return e}function xe(e,t,n,r){var o=e.c;if(n===te&&(n=e.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error($r);if(t<1)r=n===3&&(r||!!o[0])||t===0&&(n===1&&o[0]>=5||n===2&&(o[0]>5||o[0]===5&&(r||o[1]!==te))),o.length=1,r?(e.e=e.e-t+1,o[0]=1):o[0]=e.e=0;else if(t<o.length){if(r=n===1&&o[t]>=5||n===2&&(o[t]>5||o[t]===5&&(r||o[t+1]!==te||o[t-1]&1))||n===3&&(r||!!o[0]),o.length=t,r){for(;++o[--t]>9;)if(o[t]=0,t===0){++e.e,o.unshift(1);break}}for(t=o.length;!o[--t];)o.pop()}return e}function me(e,t,n){var r=e.e,o=e.c.join(""),s=o.length;if(t)o=o.charAt(0)+(s>1?"."+o.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)o="0"+o;o="0."+o}else if(r>0)if(++r>s)for(r-=s;r--;)o+="0";else r<s&&(o=o.slice(0,r)+"."+o.slice(r));else s>1&&(o=o.charAt(0)+"."+o.slice(1));return e.s<0&&n?"-"+o:o}K.abs=function(){var e=new this.constructor(this);return e.s=1,e},K.cmp=function(e){var t,n=this,r=n.c,o=(e=new n.constructor(e)).c,s=n.s,a=e.s,c=n.e,i=e.e;if(!r[0]||!o[0])return r[0]?s:o[0]?-a:0;if(s!=a)return s;if(t=s<0,c!=i)return c>i^t?1:-1;for(a=(c=r.length)<(i=o.length)?c:i,s=-1;++s<a;)if(r[s]!=o[s])return r[s]>o[s]^t?1:-1;return c==i?0:c>i^t?1:-1},K.div=function(e){var t=this,n=t.constructor,r=t.c,o=(e=new n(e)).c,s=t.s==e.s?1:-1,a=n.DP;if(a!==~~a||a<0||a>we)throw Error(Ve);if(!o[0])throw Error(sn);if(!r[0])return e.s=s,e.c=[e.e=0],e;var c,i,f,x,l,E=o.slice(),C=c=o.length,O=r.length,T=r.slice(0,c),A=T.length,D=e,m=D.c=[],y=0,B=a+(D.e=t.e-e.e)+1;for(D.s=s,s=B<0?0:B,E.unshift(0);A++<c;)T.push(0);do{for(f=0;f<10;f++){if(c!=(A=T.length))x=c>A?1:-1;else for(l=-1,x=0;++l<c;)if(o[l]!=T[l]){x=o[l]>T[l]?1:-1;break}if(x<0){for(i=A==c?o:E;A;){if(T[--A]<i[A]){for(l=A;l&&!T[--l];)T[l]=9;--T[l],T[A]+=10}T[A]-=i[A]}for(;!T[0];)T.shift()}else break}m[y++]=x?f:++f,T[0]&&x?T[A]=r[C]||0:T=[r[C]]}while((C++<O||T[0]!==te)&&s--);return!m[0]&&y!=1&&(m.shift(),D.e--,B--),y>B&&xe(D,B,n.RM,T[0]!==te),D},K.eq=function(e){return this.cmp(e)===0},K.gt=function(e){return this.cmp(e)>0},K.gte=function(e){return this.cmp(e)>-1},K.lt=function(e){return this.cmp(e)<0},K.lte=function(e){return this.cmp(e)<1},K.minus=K.sub=function(e){var t,n,r,o,s=this,a=s.constructor,c=s.s,i=(e=new a(e)).s;if(c!=i)return e.s=-i,s.plus(e);var f=s.c.slice(),x=s.e,l=e.c,E=e.e;if(!f[0]||!l[0])return l[0]?e.s=-i:f[0]?e=new a(s):e.s=1,e;if(c=x-E){for((o=c<0)?(c=-c,r=f):(E=x,r=l),r.reverse(),i=c;i--;)r.push(0);r.reverse()}else for(n=((o=f.length<l.length)?f:l).length,c=i=0;i<n;i++)if(f[i]!=l[i]){o=f[i]<l[i];break}if(o&&(r=f,f=l,l=r,e.s=-e.s),(i=(n=l.length)-(t=f.length))>0)for(;i--;)f[t++]=0;for(i=t;n>c;){if(f[--n]<l[n]){for(t=n;t&&!f[--t];)f[t]=9;--f[t],f[n]+=10}f[n]-=l[n]}for(;f[--i]===0;)f.pop();for(;f[0]===0;)f.shift(),--E;return f[0]||(e.s=1,f=[E=0]),e.c=f,e.e=E,e},K.mod=function(e){var t,n=this,r=n.constructor,o=n.s,s=(e=new r(e)).s;if(!e.c[0])throw Error(sn);return n.s=e.s=1,t=e.cmp(n)==1,n.s=o,e.s=s,t?new r(n):(o=r.DP,s=r.RM,r.DP=r.RM=0,n=n.div(e),r.DP=o,r.RM=s,this.minus(n.times(e)))},K.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e},K.plus=K.add=function(e){var t,n,r,o=this,s=o.constructor;if(e=new s(e),o.s!=e.s)return e.s=-e.s,o.minus(e);var a=o.e,c=o.c,i=e.e,f=e.c;if(!c[0]||!f[0])return f[0]||(c[0]?e=new s(o):e.s=o.s),e;if(c=c.slice(),t=a-i){for(t>0?(i=a,r=f):(t=-t,r=c),r.reverse();t--;)r.push(0);r.reverse()}for(c.length-f.length<0&&(r=f,f=c,c=r),t=f.length,n=0;t;c[t]%=10)n=(c[--t]=c[t]+f[t]+n)/10|0;for(n&&(c.unshift(n),++i),t=c.length;c[--t]===0;)c.pop();return e.c=c,e.e=i,e},K.pow=function(e){var t=this,n=new t.constructor("1"),r=n,o=e<0;if(e!==~~e||e<-on||e>on)throw Error(be+"exponent");for(o&&(e=-e);e&1&&(r=r.times(t)),e>>=1,!!e;)t=t.times(t);return o?n.div(r):r},K.prec=function(e,t){if(e!==~~e||e<1||e>we)throw Error(be+"precision");return xe(new this.constructor(this),e,t)},K.round=function(e,t){if(e===te)e=0;else if(e!==~~e||e<-we||e>we)throw Error(Ve);return xe(new this.constructor(this),e+this.e+1,t)},K.sqrt=function(){var e,t,n,r=this,o=r.constructor,s=r.s,a=r.e,c=new o("0.5");if(!r.c[0])return new o(r);if(s<0)throw Error(Ke+"No square root");s=Math.sqrt(+me(r,!0,!0)),s===0||s===1/0?(t=r.c.join(""),t.length+a&1||(t+="0"),s=Math.sqrt(t),a=((a+1)/2|0)-(a<0||a&1),e=new o((s==1/0?"5e":(s=s.toExponential()).slice(0,s.indexOf("e")+1))+a)):e=new o(s+""),a=e.e+(o.DP+=4);do n=e,e=c.times(n.plus(r.div(n)));while(n.c.slice(0,a).join("")!==e.c.slice(0,a).join(""));return xe(e,(o.DP-=4)+e.e+1,o.RM)},K.times=K.mul=function(e){var t,n=this,r=n.constructor,o=n.c,s=(e=new r(e)).c,a=o.length,c=s.length,i=n.e,f=e.e;if(e.s=n.s==e.s?1:-1,!o[0]||!s[0])return e.c=[e.e=0],e;for(e.e=i+f,a<c&&(t=o,o=s,s=t,f=a,a=c,c=f),t=new Array(f=a+c);f--;)t[f]=0;for(i=c;i--;){for(c=0,f=a+i;f>i;)c=t[f]+s[i]*o[f-i-1]+c,t[f--]=c%10,c=c/10|0;t[f]=c}for(c?++e.e:t.shift(),i=t.length;!t[--i];)t.pop();return e.c=t,e},K.toExponential=function(e,t){var n=this,r=n.c[0];if(e!==te){if(e!==~~e||e<0||e>we)throw Error(Ve);for(n=xe(new n.constructor(n),++e,t);n.c.length<e;)n.c.push(0)}return me(n,!0,!!r)},K.toFixed=function(e,t){var n=this,r=n.c[0];if(e!==te){if(e!==~~e||e<0||e>we)throw Error(Ve);for(n=xe(new n.constructor(n),e+n.e+1,t),e=e+n.e+1;n.c.length<e;)n.c.push(0)}return me(n,!1,!!r)},K.toJSON=K.toString=function(){var e=this,t=e.constructor;return me(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},typeof Symbol<"u"&&(K[Symbol.for("nodejs.util.inspect.custom")]=K.toJSON),K.toNumber=function(){var e=+me(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(e.toString()))throw Error(Ke+"Imprecise conversion");return e},K.toPrecision=function(e,t){var n=this,r=n.constructor,o=n.c[0];if(e!==te){if(e!==~~e||e<1||e>we)throw Error(be+"precision");for(n=xe(new r(n),e,t);n.c.length<e;)n.c.push(0)}return me(n,e<=n.e||n.e<=r.NE||n.e>=r.PE,!!o)},K.valueOf=function(){var e=this,t=e.constructor;if(t.strict===!0)throw Error(Ke+"valueOf disallowed");return me(e,e.e<=t.NE||e.e>=t.PE,!0)};var ne=cn();const Be=typeof Buffer=="function",an=typeof TextDecoder=="function"?new TextDecoder:void 0,fn=typeof TextEncoder=="function"?new TextEncoder:void 0,Ue=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Ye=(e=>{let t={};return e.forEach((n,r)=>t[n]=r),t})(Ue),Vr=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,$=String.fromCharCode.bind(String),un=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),ln=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),hn=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),dn=typeof btoa=="function"?e=>btoa(e):Be?e=>Buffer.from(e,"binary").toString("base64"):e=>{let t,n,r,o,s="";const a=e.length%3;for(let c=0;c<e.length;){if((n=e.charCodeAt(c++))>255||(r=e.charCodeAt(c++))>255||(o=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");t=n<<16|r<<8|o,s+=Ue[t>>18&63]+Ue[t>>12&63]+Ue[t>>6&63]+Ue[t&63]}return a?s.slice(0,a-3)+"===".substring(a):s},pt=Be?e=>Buffer.from(e).toString("base64"):e=>{let n=[];for(let r=0,o=e.length;r<o;r+=4096)n.push($.apply(null,e.subarray(r,r+4096)));return dn(n.join(""))},Yr=(e,t=!1)=>t?ln(pt(e)):pt(e),Gr=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?$(192|t>>>6)+$(128|t&63):$(224|t>>>12&15)+$(128|t>>>6&63)+$(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return $(240|t>>>18&7)+$(128|t>>>12&63)+$(128|t>>>6&63)+$(128|t&63)}},Xr=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Jr=e=>e.replace(Xr,Gr),pn=Be?e=>Buffer.from(e,"utf8").toString("base64"):fn?e=>pt(fn.encode(e)):e=>dn(Jr(e)),Wr=(e,t=!1)=>t?ln(pn(e)):pn(e),Qr=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,eo=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return $((n>>>10)+55296)+$((n&1023)+56320);case 3:return $((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return $((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},to=e=>e.replace(Qr,eo),gn=typeof atob=="function"?e=>atob(hn(e)):Be?e=>Buffer.from(e,"base64").toString("binary"):e=>{if(e=e.replace(/\s+/g,""),!Vr.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,n,r,o=[];for(let s=0;s<e.length;)t=Ye[e.charAt(s++)]<<18|Ye[e.charAt(s++)]<<12|(n=Ye[e.charAt(s++)])<<6|(r=Ye[e.charAt(s++)]),n===64?o.push($(t>>16&255)):r===64?o.push($(t>>16&255,t>>8&255)):o.push($(t>>16&255,t>>8&255,t&255));return o.join("")},yn=Be?e=>un(Buffer.from(e,"base64")):e=>un(gn(e).split("").map(t=>t.charCodeAt(0))),no=e=>yn(wn(e)),ro=Be?e=>Buffer.from(e,"base64").toString("utf8"):an?e=>an.decode(yn(e)):e=>to(gn(e)),wn=e=>hn(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),oo=e=>ro(wn(e));var so=Object.defineProperty,re=(e,t)=>so(e,"name",{value:t,configurable:!0});const gt="__fastnear_",io=re(()=>typeof localStorage<"u"?localStorage:{getItem:re(e=>Ge.get(e)||null,"getItem"),setItem:re((e,t)=>Ge.set(e,t),"setItem"),removeItem:re(e=>Ge.delete(e),"removeItem"),clear:re(()=>Ge.clear(),"clear")},"createDefaultStorage"),Ge=new Map;let Se=io();const bn={setBackend:re(e=>{Se=e},"setBackend"),set:re((e,t)=>{t==null?Se.removeItem(gt+e):Se.setItem(gt+e,JSON.stringify(t))},"set"),get:re(e=>{const t=Se.getItem(gt+e);if(t===null)return null;try{return JSON.parse(t)}catch{return t}},"get"),remove:re(e=>Se.removeItem(e),"remove"),clear:re(()=>Se.clear(),"clear")};var co=Object.defineProperty,G=(e,t)=>co(e,"name",{value:t,configurable:!0});function ao(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}G(ao,"toHex");function fo(e){if(e.length%2)throw new Error("Hex string must be even length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.slice(n,n+2),16);return t}G(fo,"fromHex");function yt(e){return no(e)}G(yt,"base64ToBytes");function uo(e){return Yr(e)}G(uo,"bytesToBase64");function lo(e){try{return Wr(e)}catch(t){return console.error("Issue base64 encoding",t),null}}G(lo,"toBase64");function ho(e){try{return oo(e)}catch(t){return console.error("Issue base64 decoding",t),null}}G(ho,"fromBase64");function po(e,...t){if(Array.isArray(e)&&(e=e.reduce((n,r,o)=>n+(t[o-1]??"")+r)),typeof e=="string"){const n=e.match(/([0-9.,_]+)\s*([a-zA-Z]+)?/);if(n){const r=n[1].replace(/[_,]/g,""),o=n[2];if(o)switch(o.toLowerCase()){case"near":return ne(r).mul(ne(10).pow(24)).toFixed(0);case"tgas":return ne(r).mul(ne(10).pow(12)).toFixed(0);case"ggas":return ne(r).mul(ne(10).pow(9)).toFixed(0);case"gas":case"yoctonear":return ne(r).toFixed(0);default:throw new Error(`Unknown unit: ${o}`)}else return ne(r).toFixed(0)}}return ne(`${e}`).toFixed(0)}G(po,"convertUnit");function go(e,t){bn.set(e,t)}G(go,"lsSet");function yo(e){return bn.get(e)}G(yo,"lsGet");function wo(e){return JSON.parse(JSON.stringify(e))}G(wo,"deepCopy");function bo(...e){try{return JSON.parse(e[0])}catch{return e.length>1?e[1]:e[0]}}G(bo,"tryParseJson");function xo(e){try{const t=new TextDecoder;return JSON.parse(t.decode(e instanceof Uint8Array?e:new Uint8Array(e)))}catch{try{return e instanceof Uint8Array?e:new Uint8Array(e)}catch{return e}}}G(xo,"parseJsonFromBytes");function mo(e){var t;return e.length===1&&e[0].type==="FunctionCall"&&ne(((t=e[0])==null?void 0:t.deposit)??"0").eq(0)}G(mo,"canSignWithLAK");var vo=Object.defineProperty,Ie=(e,t)=>vo(e,"name",{value:t,configurable:!0});const Te=Ie(e=>ke(e.includes(":")?(()=>{const[t,n]=e.split(":");if(t!=="ed25519")throw new Error(`Unsupported curve: ${t}`);return n})():e),"keyFromString"),xn=Ie(e=>`ed25519:${ze(e)}`,"keyToString");function Eo(e){const t=Te(e).slice(0,32),n=rn.getPublicKey(t);return xn(n)}Ie(Eo,"publicKeyFromPrivate");function Ao(){const e=crypto.getRandomValues(new Uint8Array(64));return xn(e)}Ie(Ao,"privateKeyFromRandom");function mn(e,t,n){const r=Te(t).slice(0,32),o=rn.sign(e,r);return n!=null&&n.returnBase58?ze(o):o}Ie(mn,"signHash");function _o(e,t){const n=or(e);return mn(n,t)}Ie(_o,"signBytes");var vn=["u8","u16","u32","u64","u128","i8","i16","i32","i64","i128","f32","f64"],Bo=function(){function e(){this.offset=0,this.buffer_size=256,this.buffer=new ArrayBuffer(this.buffer_size),this.view=new DataView(this.buffer)}return e.prototype.resize_if_necessary=function(t){if(this.buffer_size-this.offset<t){this.buffer_size=Math.max(this.buffer_size*2,this.buffer_size+t);var n=new ArrayBuffer(this.buffer_size);new Uint8Array(n).set(new Uint8Array(this.buffer)),this.buffer=n,this.view=new DataView(n)}},e.prototype.get_used_buffer=function(){return new Uint8Array(this.buffer).slice(0,this.offset)},e.prototype.store_value=function(t,n){var r=n.substring(1),o=parseInt(r)/8;this.resize_if_necessary(o);var s=n[0]==="f"?"setFloat".concat(r):n[0]==="i"?"setInt".concat(r):"setUint".concat(r);this.view[s](this.offset,t,!0),this.offset+=o},e.prototype.store_bytes=function(t){this.resize_if_necessary(t.length),new Uint8Array(this.buffer).set(new Uint8Array(t),this.offset),this.offset+=t.length},e}(),So=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();function Io(e){return Array.isArray(e)||!!e&&typeof e=="object"&&"length"in e&&typeof e.length=="number"&&(e.length===0||e.length>0&&e.length-1 in e)}function Re(e,t,n){if(typeof e!==t)throw new Error("Expected ".concat(t," not ").concat(typeof e,"(").concat(e,") at ").concat(n.join(".")))}function To(e,t){var n=["number","string","bigint","boolean"].includes(typeof e),r=typeof e=="object"&&e!==null&&"toString"in e;if(!n&&!r)throw new Error("Expected bigint, number, boolean or string not ".concat(typeof e,"(").concat(e,") at ").concat(t.join(".")))}function En(e,t,n){if(e!==t)throw new Error("Array length ".concat(e," does not match schema length ").concat(t," at ").concat(n.join(".")))}function Ro(e,t){if(typeof e!="object"||e===null)throw new Error("Expected object not ".concat(typeof e,"(").concat(e,") at ").concat(t.join(".")))}var An=vn.concat(["bool","string"]),_n=["option","enum","array","set","map","struct"],Ce=function(e){So(t,e);function t(n,r){var o="Invalid schema: ".concat(JSON.stringify(n)," expected ").concat(r);return e.call(this,o)||this}return t}(Error);function pe(e){if(!(typeof e=="string"&&An.includes(e))){if(e&&typeof e=="object"){var t=Object.keys(e);if(t.length===1&&_n.includes(t[0])){var n=t[0];if(n==="option")return pe(e[n]);if(n==="enum")return Co(e[n]);if(n==="array")return Oo(e[n]);if(n==="set")return pe(e[n]);if(n==="map")return Do(e[n]);if(n==="struct")return No(e[n])}}throw new Ce(e,_n.join(", ")+" or "+An.join(", "))}}function Co(e){if(!Array.isArray(e))throw new Ce(e,"Array");for(var t=0,n=e;t<n.length;t++){var r=n[t];if(typeof r!="object"||!("struct"in r))throw new Error('Missing "struct" key in enum schema');if(typeof r.struct!="object"||Object.keys(r.struct).length!==1)throw new Error('The "struct" in each enum must have a single key');pe({struct:r.struct})}}function Oo(e){if(typeof e!="object")throw new Ce(e,"{ type, len? }");if(e.len&&typeof e.len!="number")throw new Error("Invalid schema: ".concat(e));if("type"in e)return pe(e.type);throw new Ce(e,"{ type, len? }")}function Do(e){if(typeof e=="object"&&"key"in e&&"value"in e)pe(e.key),pe(e.value);else throw new Ce(e,"{ key, value }")}function No(e){if(typeof e!="object")throw new Ce(e,"object");for(var t in e)pe(e[t])}var ko=function(){function e(t){this.encoded=new Bo,this.fieldPath=["value"],this.checkTypes=t}return e.prototype.encode=function(t,n){return this.encode_value(t,n),this.encoded.get_used_buffer()},e.prototype.encode_value=function(t,n){if(typeof n=="string"){if(vn.includes(n))return this.encode_integer(t,n);if(n==="string")return this.encode_string(t);if(n==="bool")return this.encode_boolean(t)}if(typeof n=="object"){if("option"in n)return this.encode_option(t,n);if("enum"in n)return this.encode_enum(t,n);if("array"in n)return this.encode_array(t,n);if("set"in n)return this.encode_set(t,n);if("map"in n)return this.encode_map(t,n);if("struct"in n)return this.encode_struct(t,n)}},e.prototype.encode_integer=function(t,n){var r=parseInt(n.substring(1));r<=32||n=="f64"?(this.checkTypes&&Re(t,"number",this.fieldPath),this.encoded.store_value(t,n)):(this.checkTypes&&To(t,this.fieldPath),this.encode_bigint(BigInt(t),r))},e.prototype.encode_bigint=function(t,n){for(var r=n/8,o=new Uint8Array(r),s=0;s<r;s++)o[s]=Number(t&BigInt(255)),t=t>>BigInt(8);this.encoded.store_bytes(new Uint8Array(o))},e.prototype.encode_string=function(t){this.checkTypes&&Re(t,"string",this.fieldPath);for(var n=t,r=[],o=0;o<n.length;o++){var s=n.charCodeAt(o);s<128?r.push(s):s<2048?r.push(192|s>>6,128|s&63):s<55296||s>=57344?r.push(224|s>>12,128|s>>6&63,128|s&63):(o++,s=65536+((s&1023)<<10|n.charCodeAt(o)&1023),r.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63))}this.encoded.store_value(r.length,"u32"),this.encoded.store_bytes(new Uint8Array(r))},e.prototype.encode_boolean=function(t){this.checkTypes&&Re(t,"boolean",this.fieldPath),this.encoded.store_value(t?1:0,"u8")},e.prototype.encode_option=function(t,n){t==null?this.encoded.store_value(0,"u8"):(this.encoded.store_value(1,"u8"),this.encode_value(t,n.option))},e.prototype.encode_enum=function(t,n){this.checkTypes&&Ro(t,this.fieldPath);for(var r=Object.keys(t)[0],o=0;o<n.enum.length;o++){var s=n.enum[o];if(r===Object.keys(s.struct)[0])return this.encoded.store_value(o,"u8"),this.encode_struct(t,s)}throw new Error("Enum key (".concat(r,") not found in enum schema: ").concat(JSON.stringify(n)," at ").concat(this.fieldPath.join(".")))},e.prototype.encode_array=function(t,n){if(Io(t))return this.encode_arraylike(t,n);if(t instanceof ArrayBuffer)return this.encode_buffer(t,n);throw new Error("Expected Array-like not ".concat(typeof t,"(").concat(t,") at ").concat(this.fieldPath.join(".")))},e.prototype.encode_arraylike=function(t,n){n.array.len?En(t.length,n.array.len,this.fieldPath):this.encoded.store_value(t.length,"u32");for(var r=0;r<t.length;r++)this.encode_value(t[r],n.array.type)},e.prototype.encode_buffer=function(t,n){n.array.len?En(t.byteLength,n.array.len,this.fieldPath):this.encoded.store_value(t.byteLength,"u32"),this.encoded.store_bytes(new Uint8Array(t))},e.prototype.encode_set=function(t,n){this.checkTypes&&Re(t,"object",this.fieldPath);var r=t instanceof Set,o=r?Array.from(t.values()):Object.values(t);this.encoded.store_value(o.length,"u32");for(var s=0,a=o;s<a.length;s++){var c=a[s];this.encode_value(c,n.set)}},e.prototype.encode_map=function(t,n){this.checkTypes&&Re(t,"object",this.fieldPath);var r=t instanceof Map,o=r?Array.from(t.keys()):Object.keys(t);this.encoded.store_value(o.length,"u32");for(var s=0,a=o;s<a.length;s++){var c=a[s];this.encode_value(c,n.map.key),this.encode_value(r?t.get(c):t[c],n.map.value)}},e.prototype.encode_struct=function(t,n){this.checkTypes&&Re(t,"object",this.fieldPath);for(var r=0,o=Object.keys(n.struct);r<o.length;r++){var s=o[r];this.fieldPath.push(s),this.encode_value(t[s],n.struct[s]),this.fieldPath.pop()}},e}();function wt(e,t,n){n===void 0&&(n=!0),n&&pe(e);var r=new ko(n);return r.encode(t,e)}var Ko=Object.defineProperty,Bn=(e,t)=>Ko(e,"name",{value:t,configurable:!0});const Uo=new(Oe=class{constructor(){g(this,"Ed25519Signature",{struct:{data:{array:{type:"u8",len:64}}}});g(this,"Secp256k1Signature",{struct:{data:{array:{type:"u8",len:65}}}});g(this,"Signature",{enum:[{struct:{ed25519Signature:this.Ed25519Signature}},{struct:{secp256k1Signature:this.Secp256k1Signature}}]});g(this,"Ed25519Data",{struct:{data:{array:{type:"u8",len:32}}}});g(this,"Secp256k1Data",{struct:{data:{array:{type:"u8",len:64}}}});g(this,"PublicKey",{enum:[{struct:{ed25519Key:this.Ed25519Data}},{struct:{secp256k1Key:this.Secp256k1Data}}]});g(this,"FunctionCallPermission",{struct:{allowance:{option:"u128"},receiverId:"string",methodNames:{array:{type:"string"}}}});g(this,"FullAccessPermission",{struct:{}});g(this,"AccessKeyPermission",{enum:[{struct:{functionCall:this.FunctionCallPermission}},{struct:{fullAccess:this.FullAccessPermission}}]});g(this,"AccessKey",{struct:{nonce:"u64",permission:this.AccessKeyPermission}});g(this,"CreateAccount",{struct:{}});g(this,"DeployContract",{struct:{code:{array:{type:"u8"}}}});g(this,"FunctionCall",{struct:{methodName:"string",args:{array:{type:"u8"}},gas:"u64",deposit:"u128"}});g(this,"Transfer",{struct:{deposit:"u128"}});g(this,"Stake",{struct:{stake:"u128",publicKey:this.PublicKey}});g(this,"AddKey",{struct:{publicKey:this.PublicKey,accessKey:this.AccessKey}});g(this,"DeleteKey",{struct:{publicKey:this.PublicKey}});g(this,"DeleteAccount",{struct:{beneficiaryId:"string"}});g(this,"ClassicAction",{enum:[{struct:{createAccount:this.CreateAccount}},{struct:{deployContract:this.DeployContract}},{struct:{functionCall:this.FunctionCall}},{struct:{transfer:this.Transfer}},{struct:{stake:this.Stake}},{struct:{addKey:this.AddKey}},{struct:{deleteKey:this.DeleteKey}},{struct:{deleteAccount:this.DeleteAccount}}]});g(this,"DelegateAction",{struct:{senderId:"string",receiverId:"string",actions:{array:{type:this.ClassicAction}},nonce:"u64",maxBlockHeight:"u64",publicKey:this.PublicKey}});g(this,"SignedDelegate",{struct:{delegateAction:this.DelegateAction,signature:this.Signature}});g(this,"Action",{enum:[{struct:{createAccount:this.CreateAccount}},{struct:{deployContract:this.DeployContract}},{struct:{functionCall:this.FunctionCall}},{struct:{transfer:this.Transfer}},{struct:{stake:this.Stake}},{struct:{addKey:this.AddKey}},{struct:{deleteKey:this.DeleteKey}},{struct:{deleteAccount:this.DeleteAccount}},{struct:{signedDelegate:this.SignedDelegate}}]});g(this,"Transaction",{struct:{signerId:"string",publicKey:this.PublicKey,nonce:"u64",receiverId:"string",blockHash:{array:{type:"u8",len:32}},actions:{array:{type:this.Action}}}});g(this,"SignedTransaction",{struct:{transaction:this.Transaction,signature:this.Signature}})}},Bn(Oe,"BorshSchema"),Oe),Po=Bn(()=>Uo,"getBorshSchema");var qo=Object.defineProperty,Xe=(e,t)=>qo(e,"name",{value:t,configurable:!0});function Je(e){return{signerId:e.signerId,publicKey:{ed25519Key:{data:Te(e.publicKey)}},nonce:BigInt(e.nonce),receiverId:e.receiverId,blockHash:ke(e.blockHash),actions:e.actions.map(bt)}}Xe(Je,"mapTransaction");function jo(e){console.log("fastnear: serializing transaction");const t=Je(e);return console.log("fastnear: mapped transaction for borsh:",t),wt(xt.Transaction,t)}Xe(jo,"serializeTransaction");function Ho(e,t){console.log("fastnear: Serializing Signed Transaction",e),console.log("fastnear: signature",t),console.log("fastnear: signature length",ke(t).length);const n=Je(e);console.log("fastnear: mapped (for borsh schema) signed transaction",n);const r={transaction:n,signature:{ed25519Signature:{data:ke(t)}}},o=wt(xt.SignedTransaction,r,!0);return console.log("fastnear: borsh-serialized signed transaction:",o),o}Xe(Ho,"serializeSignedTransaction");function bt(e){switch(e.type){case"CreateAccount":return{createAccount:{}};case"DeployContract":return{deployContract:{code:yt(e.codeBase64)}};case"FunctionCall":return{functionCall:{methodName:e.methodName,args:e.argsBase64!==null&&e.argsBase64!==void 0?yt(e.argsBase64):new TextEncoder().encode(JSON.stringify(e.args)),gas:BigInt(e.gas??"300000000000000"),deposit:BigInt(e.deposit??"0")}};case"Transfer":return{transfer:{deposit:BigInt(e.deposit)}};case"Stake":return{stake:{stake:BigInt(e.stake),publicKey:{ed25519Key:{data:Te(e.publicKey)}}}};case"AddKey":return{addKey:{publicKey:{ed25519Key:{data:Te(e.publicKey)}},accessKey:{nonce:BigInt(e.accessKey.nonce),permission:e.accessKey.permission==="FullAccess"?{fullAccess:{}}:{functionCall:{allowance:e.accessKey.allowance?BigInt(e.accessKey.allowance):null,receiverId:e.accessKey.receiverId,methodNames:e.accessKey.methodNames}}}}};case"DeleteKey":return{deleteKey:{publicKey:{ed25519Key:{data:Te(e.publicKey)}}}};case"DeleteAccount":return{deleteAccount:{beneficiaryId:e.beneficiaryId}};case"SignedDelegate":return{signedDelegate:{delegateAction:bt(e.delegateAction),signature:{ed25519Signature:ke(e.signature)}}};default:throw new Error("Not implemented action: "+e.type)}}Xe(bt,"mapAction");const xt=Po(),Sn=e=>{let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)},Lo=e=>Sn(new TextEncoder().encode(e));let Mo=123;class We extends Error{constructor(n,r){super(n);g(this,"type");this.type=r}}class Pe extends Error{constructor(t,n,r){super(`${t} ${n}: ${r}`)}}class In extends Pe{constructor(t){super(0,t,"Timeout error")}}const Zo=e=>new Promise(t=>setTimeout(t,e)),Tn=Math.random()>.5,Rn=["https://relmn.aurora.dev","https://nearrpc.aurora.dev",Tn?"https://c1.rpc.fastnear.com":"https://c2.rpc.fastnear.com",Tn?"https://c2.rpc.fastnear.com":"https://c1.rpc.fastnear.com"];class Cn{constructor(t=Rn,n=3e4,r=3,o=!0){g(this,"providers");g(this,"currentProviderIndex",0);g(this,"startTimeout");this.timeout=n,this.triesCountForEveryProvider=r,this.incrementTimout=o,this.currentProviderIndex=0,this.providers=t.length>0?t:Rn,this.startTimeout=n}async block(t){return this.sendJsonRpc("block",t)}async query(t){return this.sendJsonRpc("query",t)}async txStatus(t,n,r){return this.sendJsonRpc("tx",{tx_hash:t,sender_account_id:n,wait_until:r})}async sendTransaction(t){const n=t.encode();return this.sendJsonRpc("send_tx",{signed_tx_base64:Sn(new Uint8Array(n)),wait_until:"EXECUTED_OPTIMISTIC"})}async viewMethod(t){const n=Lo(JSON.stringify(t.args)),r=await this.query({args_base64:n,finality:"optimistic",request_type:"call_function",method_name:t.methodName,account_id:t.contractId});return JSON.parse(new TextDecoder().decode(new Uint8Array(r.result)))}async sendJsonRpc(t,n,r=0){const o=this.providers[this.currentProviderIndex],s=Date.now();try{const a=await this.send(t,n,o,this.timeout);return this.timeout=Math.max(this.startTimeout,this.timeout/1.2),a}catch(a){if(a instanceof In&&this.incrementTimout&&(this.timeout=Math.min(6e4,this.timeout*1.2)),a instanceof Pe){if(this.currentProviderIndex+=1,this.providers[this.currentProviderIndex]==null&&(this.currentProviderIndex=0),r+1>this.providers.length*this.triesCountForEveryProvider)throw a;const c=500*r,i=Date.now()-s;return i<c&&await Zo(c-i),await this.sendJsonRpc(t,n,r+1)}throw a}}async send(t,n,r,o){const s=new AbortController,a=setTimeout(()=>s.abort(),o),c=await fetch(r,{body:JSON.stringify({method:t,params:n,id:Mo++,jsonrpc:"2.0"}),headers:{"Content-Type":"application/json",Referer:"https://my.herewallet.app"},signal:s.signal,method:"POST"}).catch(()=>{throw clearInterval(a),s.signal.aborted?new In("RPC Network Error"):window.navigator.onLine?new Pe(0,"RPC Network Error","Unknown Near RPC Error, maybe connection unstable, try VPN"):new Pe(0,"RPC Network Error","No internet connection")});if(clearInterval(a),!c.ok){const f=await c.text().catch(()=>"Unknown error");throw new Pe(c.status,"RPC Network Error",f)}const i=await c.json();if(i.error){if(typeof i.error.data=="object")throw typeof i.error.data.error_message=="string"&&typeof i.error.data.error_type=="string"?new We(i.error.data.error_message,i.error.data.error_type):new We(JSON.stringify(i.error.data),"ServerError");const f=`[${i.error.code}] ${i.error.message}: ${i.error.data}`;throw i.error.data==="Timeout"||f.includes("Timeout error")||f.includes("query has timed out")?new We(f,"TimeoutError"):new We(f,i.error.name||"UntypedError")}return i.result}}new Cn;var $o=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Fo={exports:{}};(function(e,t){(function(n,r){e.exports=r()})($o,function(){/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var n=Object.prototype.toString,r=Array.isArray||function(u){return n.call(u)==="[object Array]"};function o(h){return typeof h=="function"}function s(h){return r(h)?"array":typeof h}function a(h){return h.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function c(h,u){return h!=null&&typeof h=="object"&&u in h}function i(h,u){return h!=null&&typeof h!="object"&&h.hasOwnProperty&&h.hasOwnProperty(u)}var f=RegExp.prototype.test;function x(h,u){return f.call(h,u)}var l=/\S/;function E(h){return!x(l,h)}var C={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function O(h){return String(h).replace(/[&<>"'`=\/]/g,function(p){return C[p]})}var T=/\s*/,A=/\s+/,D=/\s*=/,m=/\s*\}/,y=/#|\^|\/|>|\{|&|=|!/;function B(h,u){if(!h)return[];var p=!1,d=[],v=[],_=[],I=!1,R=!1,U="",q=0;function W(){if(I&&!R)for(;_.length;)delete v[_.pop()];else _=[];I=!1,R=!1}var oe,ve,Un;function Pn(ce){if(typeof ce=="string"&&(ce=ce.split(A,2)),!r(ce)||ce.length!==2)throw new Error("Invalid tags: "+ce);oe=new RegExp(a(ce[0])+"\\s*"),ve=new RegExp("\\s*"+a(ce[1])),Un=new RegExp("\\s*"+a("}"+ce[1]))}Pn(u||S.tags);for(var Z=new P(h),ge,Y,X,je,Qe,Ee;!Z.eos();){if(ge=Z.pos,X=Z.scanUntil(oe),X)for(var mt=0,Yo=X.length;mt<Yo;++mt)je=X.charAt(mt),E(je)?(_.push(v.length),U+=je):(R=!0,p=!0,U+=" "),v.push(["text",je,ge,ge+1]),ge+=1,je===`
`&&(W(),U="",q=0,p=!1);if(!Z.scan(oe))break;if(I=!0,Y=Z.scan(y)||"name",Z.scan(T),Y==="="?(X=Z.scanUntil(D),Z.scan(D),Z.scanUntil(ve)):Y==="{"?(X=Z.scanUntil(Un),Z.scan(m),Z.scanUntil(ve),Y="&"):X=Z.scanUntil(ve),!Z.scan(ve))throw new Error("Unclosed tag at "+Z.pos);if(Y==">"?Qe=[Y,X,ge,Z.pos,U,q,p]:Qe=[Y,X,ge,Z.pos],q++,v.push(Qe),Y==="#"||Y==="^")d.push(Qe);else if(Y==="/"){if(Ee=d.pop(),!Ee)throw new Error('Unopened section "'+X+'" at '+ge);if(Ee[1]!==X)throw new Error('Unclosed section "'+Ee[1]+'" at '+ge)}else Y==="name"||Y==="{"||Y==="&"?R=!0:Y==="="&&Pn(X)}if(W(),Ee=d.pop(),Ee)throw new Error('Unclosed section "'+Ee[1]+'" at '+Z.pos);return j(N(v))}function N(h){for(var u=[],p,d,v=0,_=h.length;v<_;++v)p=h[v],p&&(p[0]==="text"&&d&&d[0]==="text"?(d[1]+=p[1],d[3]=p[3]):(u.push(p),d=p));return u}function j(h){for(var u=[],p=u,d=[],v,_,I=0,R=h.length;I<R;++I)switch(v=h[I],v[0]){case"#":case"^":p.push(v),d.push(v),p=v[4]=[];break;case"/":_=d.pop(),_[5]=v[2],p=d.length>0?d[d.length-1][4]:u;break;default:p.push(v)}return u}function P(h){this.string=h,this.tail=h,this.pos=0}P.prototype.eos=function(){return this.tail===""},P.prototype.scan=function(u){var p=this.tail.match(u);if(!p||p.index!==0)return"";var d=p[0];return this.tail=this.tail.substring(d.length),this.pos+=d.length,d},P.prototype.scanUntil=function(u){var p=this.tail.search(u),d;switch(p){case-1:d=this.tail,this.tail="";break;case 0:d="";break;default:d=this.tail.substring(0,p),this.tail=this.tail.substring(p)}return this.pos+=d.length,d};function b(h,u){this.view=h,this.cache={".":this.view},this.parent=u}b.prototype.push=function(u){return new b(u,this)},b.prototype.lookup=function(u){var p=this.cache,d;if(p.hasOwnProperty(u))d=p[u];else{for(var v=this,_,I,R,U=!1;v;){if(u.indexOf(".")>0)for(_=v.view,I=u.split("."),R=0;_!=null&&R<I.length;)R===I.length-1&&(U=c(_,I[R])||i(_,I[R])),_=_[I[R++]];else _=v.view[u],U=c(v.view,u);if(U){d=_;break}v=v.parent}p[u]=d}return o(d)&&(d=d.call(this.view)),d};function w(){this.templateCache={_cache:{},set:function(u,p){this._cache[u]=p},get:function(u){return this._cache[u]},clear:function(){this._cache={}}}}w.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()},w.prototype.parse=function(u,p){var d=this.templateCache,v=u+":"+(p||S.tags).join(":"),_=typeof d<"u",I=_?d.get(v):void 0;return I==null&&(I=B(u,p),_&&d.set(v,I)),I},w.prototype.render=function(u,p,d,v){var _=this.parse(u,v),I=p instanceof b?p:new b(p,void 0);return this.renderTokens(_,I,d,u,v)},w.prototype.renderTokens=function(u,p,d,v,_){for(var I="",R,U,q,W=0,oe=u.length;W<oe;++W)q=void 0,R=u[W],U=R[0],U==="#"?q=this.renderSection(R,p,d,v):U==="^"?q=this.renderInverted(R,p,d,v):U===">"?q=this.renderPartial(R,p,d,_):U==="&"?q=this.unescapedValue(R,p):U==="name"?q=this.escapedValue(R,p):U==="text"&&(q=this.rawValue(R)),q!==void 0&&(I+=q);return I},w.prototype.renderSection=function(u,p,d,v){var _=this,I="",R=p.lookup(u[1]);function U(oe){return _.render(oe,p,d)}if(R){if(r(R))for(var q=0,W=R.length;q<W;++q)I+=this.renderTokens(u[4],p.push(R[q]),d,v);else if(typeof R=="object"||typeof R=="string"||typeof R=="number")I+=this.renderTokens(u[4],p.push(R),d,v);else if(o(R)){if(typeof v!="string")throw new Error("Cannot use higher-order sections without the original template");R=R.call(p.view,v.slice(u[3],u[5]),U),R!=null&&(I+=R)}else I+=this.renderTokens(u[4],p,d,v);return I}},w.prototype.renderInverted=function(u,p,d,v){var _=p.lookup(u[1]);if(!_||r(_)&&_.length===0)return this.renderTokens(u[4],p,d,v)},w.prototype.indentPartial=function(u,p,d){for(var v=p.replace(/[^ \t]/g,""),_=u.split(`
`),I=0;I<_.length;I++)_[I].length&&(I>0||!d)&&(_[I]=v+_[I]);return _.join(`
`)},w.prototype.renderPartial=function(u,p,d,v){if(d){var _=o(d)?d(u[1]):d[u[1]];if(_!=null){var I=u[6],R=u[5],U=u[4],q=_;return R==0&&U&&(q=this.indentPartial(_,U,I)),this.renderTokens(this.parse(q,v),p,d,q)}}},w.prototype.unescapedValue=function(u,p){var d=p.lookup(u[1]);if(d!=null)return d},w.prototype.escapedValue=function(u,p){var d=p.lookup(u[1]);if(d!=null)return S.escape(d)},w.prototype.rawValue=function(u){return u[1]};var S={name:"mustache.js",version:"4.0.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(h){k.templateCache=h},get templateCache(){return k.templateCache}},k=new w;return S.clearCache=function(){return k.clearCache()},S.parse=function(u,p){return k.parse(u,p)},S.render=function(u,p,d,v){if(typeof u!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+s(u)+'" was given as the first argument for mustache#render(template, view, partials)');return k.render(u,p,d,v)},S.escape=O,S.Scanner=P,S.Context=b,S.Writer=w,S})})(Fo);var On;(function(e){e.Transaction="transaction",e.Receipt="receipt"})(On||(On={}));var Dn;(function(e){e.Unknown="Unknown",e.Pending="Pending",e.Failure="Failure"})(Dn||(Dn={}));var Nn;(function(e){e.NotStarted="NotStarted",e.Started="Started",e.Failure="Failure"})(Nn||(Nn={})),10n**BigInt(24);const zo=e=>{let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)},Vo=e=>e.map(t=>{if(!("type"in t))return t;switch(t.type){case"FunctionCall":return{type:"FunctionCall",methodName:t.params.methodName,args:t.params.args,gas:t.params.gas,deposit:t.params.deposit};case"Transfer":return{type:"Transfer",deposit:t.params.deposit};case"AddKey":return{type:"AddKey",publicKey:t.params.publicKey,accessKey:{nonce:t.params.accessKey.nonce??0,permission:t.params.accessKey.permission==="FullAccess"?"FullAccess":{receiverId:t.params.accessKey.permission.receiverId,methodNames:t.params.accessKey.permission.methodNames??[],allowance:t.params.accessKey.permission.allowance}}};case"DeleteKey":return{type:"DeleteKey",publicKey:t.params.publicKey};case"CreateAccount":return{type:"CreateAccount"};case"DeleteAccount":return{type:"DeleteAccount",beneficiaryId:t.params.beneficiaryId};case"DeployContract":return{type:"DeployContract",codeBase64:zo(t.params.code)};case"Stake":return{type:"Stake",stake:t.params.stake,publicKey:t.params.publicKey};default:throw new Error("Unsupported action type")}}),kn=async(e,t,n)=>{const r=new Cn([n.nodeUrl]),o=[];for(let s=0;s<e.length;s++){const[a,c]=await Promise.all([r.block({finality:"final"}),r.query({request_type:"view_access_key",finality:"final",account_id:e[s].signerId,public_key:t})]),i={signerId:e[s].signerId,publicKey:t,receiverId:e[s].receiverId,nonce:c.nonce+s+1,blockHash:a.header.hash,actions:Vo(e[s].actions)},f=new Uint8Array(wt(xt.Transaction,Je(i))),x=await window.selector.external("nightly.near","signTransaction",f,!0);o.push(x)}return o},Kn={mainnet:{nodeUrl:"https://relmn.aurora.dev",networkId:"mainnet",helperUrl:"",explorerUrl:"",indexerUrl:""},testnet:{nodeUrl:"https://test.rpc.fastnear.com",networkId:"testnet",helperUrl:"",explorerUrl:"",indexerUrl:""}},qe=async()=>{try{await window.selector.external("nightly.near","isConnected")}catch{await window.selector.ui.whenApprove({title:"Download Nightly",button:"Download"}),window.selector.open("https://chromewebstore.google.com/detail/nightly/fiikommddbeccaoicoejoniammnalkfa")}};(async()=>{await window.selector.external("nightly.near","connect").catch(()=>{});const e=async()=>{const{accountId:t,publicKey:n}=await window.selector.external("nightly.near","account");return t?n.ed25519Key?[{accountId:t,publicKey:`ed25519:${ze(new Uint8Array(n.ed25519Key.data))}`}]:[{accountId:t,publicKey:`ed25519:${ze(new Uint8Array(n.data))}`}]:[]};return{async signIn({contractId:t,methodNames:n}){await qe();const r=await e();return r.length?r:(await window.selector.external("nightly.near","connect",{contractId:t,methodNames:n}),e())},async signOut(){await qe(),await window.selector.external("nightly.near","disconnect")},async getAccounts(){return await e()},async verifyOwner({message:t}){throw new Error("Method not supported")},async signMessage({message:t,nonce:n,recipient:r,state:o}){return await qe(),await window.selector.external("nightly.near","isConnected")||await window.selector.external("nightly.near","connect"),await window.selector.external("nightly.near","signMessage",{nonce:Array.from(n),recipient:r,message:t,state:o})},async signAndSendTransaction({receiverId:t,actions:n,network:r}){await qe();const o=await e();if(!o.length)throw new Error("Wallet not signed in");const s=o[0].accountId,a=o[0].publicKey;return(await kn([{signerId:s,receiverId:t,actions:n}],a,Kn[r]))[0]},async signAndSendTransactions({transactions:t,network:n}){await qe();const r=await e();if(!r.length)throw new Error("Wallet not signed in");const o=r[0].accountId,s=r[0].publicKey,a=t.map(c=>({...c,signerId:o}));return await kn(a,s,Kn[n])},async getPublicKey(){const n=(await e())[0];if(!n)throw new Error("Failed to find public key for account");return n.publicKey},async signDelegateAction(t){throw new Error("Method not supported")}}})().then(e=>{window.selector.ready(e)})})();
